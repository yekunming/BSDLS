<Activity mc:Ignorable="sap sap2010" x:Class="DataDispose_按揭放款" xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities" xmlns:av="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:mva="clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities" xmlns:s="clr-namespace:System;assembly=mscorlib" xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation" xmlns:sap2010="http://schemas.microsoft.com/netfx/2010/xaml/activities/presentation" xmlns:scg="clr-namespace:System.Collections.Generic;assembly=mscorlib" xmlns:sd="clr-namespace:System.Data;assembly=System.Data" xmlns:str="clr-namespace:System.Text.RegularExpressions;assembly=System" xmlns:ui="http://schemas.uipath.com/workflow/activities" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <x:Members>
    <x:Property Name="in_Config" Type="InArgument(scg:Dictionary(x:String, x:Object))" />
  </x:Members>
  <mva:VisualBasic.Settings>
    <x:Null />
  </mva:VisualBasic.Settings>
  <sap:VirtualizedContainerService.HintSize>1088,3859</sap:VirtualizedContainerService.HintSize>
  <sap2010:WorkflowViewState.IdRef>DataDispose_按揭放款_1</sap2010:WorkflowViewState.IdRef>
  <TextExpression.NamespacesForImplementation>
    <scg:List x:TypeArguments="x:String" Capacity="48">
      <x:String>System.Activities</x:String>
      <x:String>System.Activities.Statements</x:String>
      <x:String>System.Activities.Expressions</x:String>
      <x:String>System.Activities.Validation</x:String>
      <x:String>System.Activities.XamlIntegration</x:String>
      <x:String>Microsoft.VisualBasic</x:String>
      <x:String>Microsoft.VisualBasic.Activities</x:String>
      <x:String>System</x:String>
      <x:String>System.Collections</x:String>
      <x:String>System.Collections.Generic</x:String>
      <x:String>System.Data</x:String>
      <x:String>System.Diagnostics</x:String>
      <x:String>System.Drawing</x:String>
      <x:String>System.IO</x:String>
      <x:String>System.Linq</x:String>
      <x:String>System.Net.Mail</x:String>
      <x:String>System.Xml</x:String>
      <x:String>System.Xml.Linq</x:String>
      <x:String>UiPath.Core</x:String>
      <x:String>UiPath.Core.Activities</x:String>
      <x:String>System.Windows.Markup</x:String>
      <x:String>UiPath.Excel</x:String>
      <x:String>System.Xml.Serialization</x:String>
      <x:String>System.Text.RegularExpressions</x:String>
      <x:String>System.ComponentModel</x:String>
      <x:String>System.Runtime.Serialization</x:String>
      <x:String>System.Collections.ObjectModel</x:String>
      <x:String>System.Activities.DynamicUpdate</x:String>
    </scg:List>
  </TextExpression.NamespacesForImplementation>
  <TextExpression.ReferencesForImplementation>
    <scg:List x:TypeArguments="AssemblyReference" Capacity="50">
      <AssemblyReference>System.Activities</AssemblyReference>
      <AssemblyReference>Microsoft.VisualBasic</AssemblyReference>
      <AssemblyReference>mscorlib</AssemblyReference>
      <AssemblyReference>System.Data</AssemblyReference>
      <AssemblyReference>System.Data.DataSetExtensions</AssemblyReference>
      <AssemblyReference>System</AssemblyReference>
      <AssemblyReference>System.Drawing</AssemblyReference>
      <AssemblyReference>System.Core</AssemblyReference>
      <AssemblyReference>System.Xml</AssemblyReference>
      <AssemblyReference>System.Xml.Linq</AssemblyReference>
      <AssemblyReference>PresentationFramework</AssemblyReference>
      <AssemblyReference>WindowsBase</AssemblyReference>
      <AssemblyReference>PresentationCore</AssemblyReference>
      <AssemblyReference>System.Xaml</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities</AssemblyReference>
      <AssemblyReference>UiPath.UiAutomation.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Excel.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Excel</AssemblyReference>
      <AssemblyReference>System.ValueTuple</AssemblyReference>
      <AssemblyReference>UiPath.Mail</AssemblyReference>
      <AssemblyReference>UiPath.CV</AssemblyReference>
      <AssemblyReference>System.ServiceModel</AssemblyReference>
      <AssemblyReference>System.ComponentModel.Composition</AssemblyReference>
      <AssemblyReference>System.Memory</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities.Design</AssemblyReference>
      <AssemblyReference>UiPath.OCR.Activities.Design</AssemblyReference>
      <AssemblyReference>Microsoft.Bcl.AsyncInterfaces</AssemblyReference>
      <AssemblyReference>UiPath.UIAutomationCore</AssemblyReference>
    </scg:List>
  </TextExpression.ReferencesForImplementation>
  <Sequence DisplayName="序列" sap:VirtualizedContainerService.HintSize="1098,3694" sap2010:WorkflowViewState.IdRef="Sequence_70">
    <Sequence.Variables>
      <Variable x:TypeArguments="scg:IEnumerable(str:Match)" Name="MatchsReuslt" />
      <Variable x:TypeArguments="x:Boolean" Name="blPathExists" />
      <Variable x:TypeArguments="sd:DataTable" Name="dtErrorTable" />
      <Variable x:TypeArguments="x:Double" Name="dblToltal" />
      <Variable x:TypeArguments="x:String" Default="0" Name="strSerialNumber3" />
      <Variable x:TypeArguments="scg:Dictionary(x:String, x:String)" Default="[New Dictionary(of String,String)]" Name="dicArchives" />
      <Variable x:TypeArguments="sd:DataTable" Name="dtErrorRow" />
      <Variable x:TypeArguments="sd:DataRow[]" Name="arrOverdue" />
      <Variable x:TypeArguments="scg:Dictionary(x:String, s:String[])" Default="[New Dictionary(of String,String())]" Name="dicReceivable" />
      <Variable x:TypeArguments="sd:DataTable" Name="dtReceivable" />
      <Variable x:TypeArguments="x:String" Name="strSerialNumber2" />
      <Variable x:TypeArguments="x:Int32" Name="iCount2" />
      <Variable x:TypeArguments="s:String[]" Default="[{&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;}]" Name="arrSubTable" />
      <Variable x:TypeArguments="sd:DataTable" Name="dtOverdue" />
      <Variable x:TypeArguments="sd:DataTable" Name="dtOverduePending" />
      <Variable x:TypeArguments="x:Double" Name="dblPayment" />
      <Variable x:TypeArguments="sd:DataTable" Name="dtRepaymentSchedule" />
      <Variable x:TypeArguments="sd:DataTable" Default="[New DataTable]" Name="dtMaket" />
      <Variable x:TypeArguments="sd:DataTable" Default="[New DataTable]" Name="dtPayment" />
      <Variable x:TypeArguments="x:String" sap2010:Annotation.AnnotationText="编号" Name="strSerialNumber" />
      <Variable x:TypeArguments="scg:Dictionary(x:String, s:String[])" sap2010:Annotation.AnnotationText="待处理流水清单配置页客户信息储存字典" Default="[New Dictionary(of String,String())]" Name="dicPendingTask" />
      <Variable x:TypeArguments="sd:DataTable" sap2010:Annotation.AnnotationText="待处理流水清单客户明细配置页数据表" Name="dtConfigTable" />
      <Variable x:TypeArguments="x:Int32" sap2010:Annotation.AnnotationText="计量数" Default="0" Name="iCount" />
      <Variable x:TypeArguments="s:String[]" sap2010:Annotation.AnnotationText="按揭放款新增数据行储存数组" Default="[{&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;}]" Name="arrMainTable" />
      <Variable x:TypeArguments="scg:Dictionary(x:String, s:String[])" sap2010:Annotation.AnnotationText="放款明细信息储存字典" Default="[New Dictionary(of String,String())]" Name="dicLoanDetails" />
      <Variable x:TypeArguments="sd:DataTable" sap2010:Annotation.AnnotationText="按揭放款收款单模板表档案项页" Name="dtArchivesTable" />
      <Variable x:TypeArguments="sd:DataTable" sap2010:Annotation.AnnotationText="按揭放款收款单模板表子表页" Name="dtSubTable" />
      <Variable x:TypeArguments="sd:DataTable" sap2010:Annotation.AnnotationText="按揭放款收款单模板表主表页" Name="dtMainTable" />
      <Variable x:TypeArguments="sd:DataTable" sap2010:Annotation.AnnotationText="放款明细表" Name="dtLoanDetails" />
      <Variable x:TypeArguments="sd:DataTable" sap2010:Annotation.AnnotationText="NC-SAP流水表" Name="dtSourceTable" />
      <Variable x:TypeArguments="scg:Dictionary(x:String, s:String[])" Default="[New Dictionary(of String,String())]" Name="dicSubTotalTable" />
      <Variable x:TypeArguments="s:String[]" Name="arrCollects" />
      <Variable x:TypeArguments="scg:Dictionary(x:String, x:String)" Default="[New Dictionary(of String,String)]" Name="dicCollectsOfMainTable" />
      <Variable x:TypeArguments="scg:Dictionary(x:String, s:String[])" Default="[New Dictionary(of String,String())]" Name="dicCollectsOfLoanDetails" />
      <Variable x:TypeArguments="scg:Dictionary(x:String, x:String)" Default="[New Dictionary(of String,String)]" Name="dicCollectsPending" />
      <Variable x:TypeArguments="sd:DataTable" Name="dtCollects" />
      <Variable x:TypeArguments="x:String" Name="strCellPosition" />
      <Variable x:TypeArguments="sd:DataTable" Name="dtNetSilverWater" />
      <Variable x:TypeArguments="scg:Dictionary(x:String, x:String)" Default="[New Dictionary(of String,String)]" Name="dicNetSilverWater" />
    </Sequence.Variables>
    <sap:WorkflowViewStateService.ViewState>
      <scg:Dictionary x:TypeArguments="x:String, x:Object">
        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
      </scg:Dictionary>
    </sap:WorkflowViewStateService.ViewState>
    <Sequence DisplayName="DataDispose_按揭放款" sap:VirtualizedContainerService.HintSize="1056,3602" sap2010:WorkflowViewState.IdRef="Sequence_1">
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          <x:Boolean x:Key="IsPinned">False</x:Boolean>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <ui:PathExists DisplayName="路径存在" Exists="[blPathExists]" sap:VirtualizedContainerService.HintSize="1014,91" sap2010:WorkflowViewState.IdRef="PathExists_2" Path="[in_Config(&quot;XZB&quot;).ToString+in_Config(&quot;NCSAP&quot;).ToString]" PathType="File" />
      <If Condition="[blPathExists]" DisplayName="IF 条件" sap:VirtualizedContainerService.HintSize="1014,3379" sap2010:WorkflowViewState.IdRef="If_39">
        <If.Then>
          <Flowchart DisplayName="流程图" sap:VirtualizedContainerService.HintSize="635,3226" sap2010:WorkflowViewState.IdRef="Flowchart_5">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                <av:Point x:Key="ShapeLocation">270,2.5</av:Point>
                <av:Size x:Key="ShapeSize">60,75</av:Size>
                <av:PointCollection x:Key="ConnectorLocation">300,77.5 300,127.5</av:PointCollection>
                <x:Double x:Key="Width">600.69115632693376</x:Double>
                <x:Double x:Key="Height">3189.5</x:Double>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <Flowchart.StartNode>
              <x:Reference>__ReferenceID40</x:Reference>
            </Flowchart.StartNode>
            <FlowStep x:Name="__ReferenceID40">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <av:Point x:Key="ShapeLocation">200,127.5</av:Point>
                  <av:Size x:Key="ShapeSize">200,150</av:Size>
                  <av:PointCollection x:Key="ConnectorLocation">300,277.5 300,316.5</av:PointCollection>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <Sequence sap2010:Annotation.AnnotationText="从CRM下载更新的客户未收明细表（还款计划）&#xA;并将垫付表与销售表合并为一个表" DisplayName="客户未收明细下载更新" sap:VirtualizedContainerService.HintSize="200,150" sap2010:WorkflowViewState.IdRef="Sequence_15">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke CRM_Login workflow" sap:VirtualizedContainerService.HintSize="976,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_1" UnSafe="False" WorkflowFileName="ProcessBusiness\Download\CRM_Login.xaml">
                  <ui:InvokeWorkflowFile.Arguments>
                    <InArgument x:TypeArguments="scg:Dictionary(x:String, x:Object)" x:Key="in_Config">[in_Config]</InArgument>
                  </ui:InvokeWorkflowFile.Arguments>
                </ui:InvokeWorkflowFile>
                <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke DataDown_客户未收明细 workflow" sap:VirtualizedContainerService.HintSize="976,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_2" UnSafe="False" WorkflowFileName="ProcessBusiness/Download/DataDown_001_主机应收_还款计划下载.xaml">
                  <ui:InvokeWorkflowFile.Arguments>
                    <InArgument x:TypeArguments="scg:Dictionary(x:String, x:Object)" x:Key="in_Config">[in_Config]</InArgument>
                    <InArgument x:TypeArguments="x:String" x:Key="ProcessName">按揭放款</InArgument>
                  </ui:InvokeWorkflowFile.Arguments>
                </ui:InvokeWorkflowFile>
                <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke CRM_LogOut workflow" sap:VirtualizedContainerService.HintSize="976,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_3" UnSafe="False" WorkflowFileName="ProcessBusiness\Download\CRM_LogOut.xaml">
                  <ui:InvokeWorkflowFile.Arguments>
                    <scg:Dictionary x:TypeArguments="x:String, Argument" />
                  </ui:InvokeWorkflowFile.Arguments>
                </ui:InvokeWorkflowFile>
                <Sequence sap2010:Annotation.AnnotationText="合并客户未收明细垫付表与销售表，写入中间表(还款计划新表)&#xA;返回：dtRepaymentSchedule" DisplayName="合并客户未收明细垫付表与销售表" sap:VirtualizedContainerService.HintSize="976,2711" sap2010:WorkflowViewState.IdRef="Sequence_14">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <ui:PathExists DisplayName="路径存在" Exists="[blPathExists]" sap:VirtualizedContainerService.HintSize="934,91" sap2010:WorkflowViewState.IdRef="PathExists_3" Path="[in_Config(&quot;XZB&quot;).ToString+in_Config(&quot;KHWSMX_AJ_DF&quot;).ToString]" PathType="File" />
                  <If Condition="[blPathExists]" DisplayName="IF 条件" sap:VirtualizedContainerService.HintSize="934,413" sap2010:WorkflowViewState.IdRef="If_40">
                    <If.Then>
                      <ui:ExcelApplicationScope Password="{x:Null}" DisplayName="垫付款" sap:VirtualizedContainerService.HintSize="443,260" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_5" InstanceCachePeriod="3000" WorkbookPath="[in_Config(&quot;XZB&quot;).ToString+in_Config(&quot;KHWSMX_AJ_DF&quot;).ToString]">
                        <ui:ExcelApplicationScope.Body>
                          <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                            <ActivityAction.Argument>
                              <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                            </ActivityAction.Argument>
                            <Sequence DisplayName="执行" sap:VirtualizedContainerService.HintSize="376,151" sap2010:WorkflowViewState.IdRef="Sequence_10">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <ui:ExcelReadRange AddHeaders="True" DataTable="[dtPayment]" DisplayName="读取范围" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="ExcelReadRange_7" SheetName="客户未收明细-按揭放款垫付款">
                                <ui:ExcelReadRange.Range>
                                  <InArgument x:TypeArguments="x:String">
                                    <Literal x:TypeArguments="x:String" Value="" />
                                  </InArgument>
                                </ui:ExcelReadRange.Range>
                              </ui:ExcelReadRange>
                            </Sequence>
                          </ActivityAction>
                        </ui:ExcelApplicationScope.Body>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                      </ui:ExcelApplicationScope>
                    </If.Then>
                  </If>
                  <ui:PathExists DisplayName="路径存在" Exists="[blPathExists]" sap:VirtualizedContainerService.HintSize="934,91" sap2010:WorkflowViewState.IdRef="PathExists_4" Path="[in_Config(&quot;XZB&quot;).ToString+in_Config(&quot;KHWSMX_AJ_XS&quot;).ToString]" PathType="File" />
                  <If Condition="[blPathExists]" DisplayName="IF 条件" sap:VirtualizedContainerService.HintSize="934,408" sap2010:WorkflowViewState.IdRef="If_41">
                    <If.Then>
                      <ui:ExcelApplicationScope Password="{x:Null}" DisplayName="销售款" sap:VirtualizedContainerService.HintSize="445,260" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_6" InstanceCachePeriod="3000" WorkbookPath="[in_Config(&quot;XZB&quot;).ToString+in_Config(&quot;KHWSMX_AJ_XS&quot;).ToString]">
                        <ui:ExcelApplicationScope.Body>
                          <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                            <ActivityAction.Argument>
                              <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                            </ActivityAction.Argument>
                            <Sequence DisplayName="执行" sap:VirtualizedContainerService.HintSize="376,151" sap2010:WorkflowViewState.IdRef="Sequence_11">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <ui:ExcelReadRange AddHeaders="True" DataTable="[dtMaket]" DisplayName="读取范围" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="ExcelReadRange_8" SheetName="客户未收明细-按揭放款销售款">
                                <ui:ExcelReadRange.Range>
                                  <InArgument x:TypeArguments="x:String">
                                    <Literal x:TypeArguments="x:String" Value="" />
                                  </InArgument>
                                </ui:ExcelReadRange.Range>
                              </ui:ExcelReadRange>
                            </Sequence>
                          </ActivityAction>
                        </ui:ExcelApplicationScope.Body>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                      </ui:ExcelApplicationScope>
                    </If.Then>
                  </If>
                  <ui:ExcelApplicationScope Password="{x:Null}" DisplayName="还款计划（垫付与销售表合并）" sap:VirtualizedContainerService.HintSize="934,1410" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_7" InstanceCachePeriod="3000" WorkbookPath="[in_Config(&quot;ZJB&quot;).ToString+in_Config(&quot;AJFKHKJH&quot;).ToString]">
                    <ui:ExcelApplicationScope.Body>
                      <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                        <ActivityAction.Argument>
                          <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                        </ActivityAction.Argument>
                        <Sequence DisplayName="执行" sap:VirtualizedContainerService.HintSize="900,1301" sap2010:WorkflowViewState.IdRef="Sequence_13">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <If Condition="[dtMaket.Rows.Count&gt;0]" DisplayName="IF 条件" sap:VirtualizedContainerService.HintSize="858,234" sap2010:WorkflowViewState.IdRef="If_42">
                            <If.Then>
                              <ui:ExcelWriteRange AddHeaders="True" DataTable="[dtMaket]" DisplayName="写入范围" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteRange_1" SheetName="Sheet1" StartingCell="A1" />
                            </If.Then>
                          </If>
                          <If Condition="[dtPayment.Rows.Count&gt;0]" DisplayName="IF 条件" sap:VirtualizedContainerService.HintSize="858,381" sap2010:WorkflowViewState.IdRef="If_43">
                            <If.Then>
                              <If Condition="[dtMaket.Rows.Count&gt;0]" DisplayName="IF 条件" sap:VirtualizedContainerService.HintSize="713,234" sap2010:WorkflowViewState.IdRef="If_44">
                                <If.Then>
                                  <ui:ExcelAppendRange DataTable="[dtPayment]" DisplayName="附加范围" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelAppendRange_1" SheetName="Sheet1" />
                                </If.Then>
                                <If.Else>
                                  <ui:ExcelWriteRange AddHeaders="True" DataTable="[dtPayment]" DisplayName="写入范围" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteRange_8" SheetName="Sheet1" StartingCell="A1" />
                                </If.Else>
                              </If>
                            </If.Then>
                          </If>
                          <ui:ExcelReadRange AddHeaders="True" DataTable="[dtRepaymentSchedule]" DisplayName="读取范围" sap:VirtualizedContainerService.HintSize="858,59" sap2010:WorkflowViewState.IdRef="ExcelReadRange_9" SheetName="Sheet1">
                            <ui:ExcelReadRange.Range>
                              <InArgument x:TypeArguments="x:String">
                                <Literal x:TypeArguments="x:String" Value="" />
                              </InArgument>
                            </ui:ExcelReadRange.Range>
                          </ui:ExcelReadRange>
                          <ui:ExcelAutoFillRange DisplayName="自动填充范围" FillRange="[&quot;A2:A&quot;+(dtRepaymentSchedule.Rows.Count+1).ToString]" sap:VirtualizedContainerService.HintSize="858,87" sap2010:WorkflowViewState.IdRef="ExcelAutoFillRange_1" SheetName="Sheet1" SourceRange="[“A2:A3”]" />
                          <ui:ExcelReadRange AddHeaders="True" DataTable="[dtRepaymentSchedule]" DisplayName="读取范围" sap:VirtualizedContainerService.HintSize="858,59" sap2010:WorkflowViewState.IdRef="ExcelReadRange_10" SheetName="Sheet1">
                            <ui:ExcelReadRange.Range>
                              <InArgument x:TypeArguments="x:String">
                                <Literal x:TypeArguments="x:String" Value="" />
                              </InArgument>
                            </ui:ExcelReadRange.Range>
                          </ui:ExcelReadRange>
                          <ui:FilterDataTable DataTable="[dtRepaymentSchedule]" DisplayName="仅保留按揭放款与融资放款" FilterRowsMode="Keep" sap:VirtualizedContainerService.HintSize="858,59" sap2010:WorkflowViewState.IdRef="FilterDataTable_1" OutputDataTable="[dtRepaymentSchedule]" SelectColumnsMode="Keep">
                            <ui:FilterDataTable.Filters>
                              <scg:List x:TypeArguments="ui:FilterOperationArgument" Capacity="4">
                                <ui:FilterOperationArgument BooleanOperator="And" Operator="EQ">
                                  <ui:FilterOperationArgument.Column>
                                    <InArgument x:TypeArguments="x:String">["收款项目"]</InArgument>
                                  </ui:FilterOperationArgument.Column>
                                  <ui:FilterOperationArgument.Operand>
                                    <InArgument x:TypeArguments="x:String">["按揭放款"]</InArgument>
                                  </ui:FilterOperationArgument.Operand>
                                </ui:FilterOperationArgument>
                                <ui:FilterOperationArgument BooleanOperator="Or" Operator="EQ">
                                  <ui:FilterOperationArgument.Column>
                                    <InArgument x:TypeArguments="x:String">["收款项目"]</InArgument>
                                  </ui:FilterOperationArgument.Column>
                                  <ui:FilterOperationArgument.Operand>
                                    <InArgument x:TypeArguments="x:String">["融资放款"]</InArgument>
                                  </ui:FilterOperationArgument.Operand>
                                </ui:FilterOperationArgument>
                              </scg:List>
                            </ui:FilterDataTable.Filters>
                            <ui:FilterDataTable.SelectColumns>
                              <scg:List x:TypeArguments="InArgument" Capacity="4">
                                <x:Null />
                              </scg:List>
                            </ui:FilterDataTable.SelectColumns>
                          </ui:FilterDataTable>
                          <ui:FilterDataTable sap2010:Annotation.AnnotationText="应还款时间 &lt; 下月1号的保留" DataTable="[dtRepaymentSchedule]" DisplayName="筛选出逾期款" FilterRowsMode="Keep" sap:VirtualizedContainerService.HintSize="858,90" sap2010:WorkflowViewState.IdRef="FilterDataTable_11" OutputDataTable="[dtRepaymentSchedule]" SelectColumnsMode="Keep">
                            <ui:FilterDataTable.Filters>
                              <scg:List x:TypeArguments="ui:FilterOperationArgument" Capacity="4">
                                <ui:FilterOperationArgument BooleanOperator="And" Operator="LT">
                                  <ui:FilterOperationArgument.Column>
                                    <InArgument x:TypeArguments="x:String">["应还款时间"]</InArgument>
                                  </ui:FilterOperationArgument.Column>
                                  <ui:FilterOperationArgument.Operand>
                                    <InArgument x:TypeArguments="x:Int32">[cint(CDate(in_Config("ProcessStartTime")).AddMonths(1).ToString("yyyyMM01"))]</InArgument>
                                  </ui:FilterOperationArgument.Operand>
                                </ui:FilterOperationArgument>
                              </scg:List>
                            </ui:FilterDataTable.Filters>
                            <ui:FilterDataTable.SelectColumns>
                              <scg:List x:TypeArguments="InArgument" Capacity="4">
                                <x:Null />
                              </scg:List>
                            </ui:FilterDataTable.SelectColumns>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </ui:FilterDataTable>
                        </Sequence>
                      </ActivityAction>
                    </ui:ExcelApplicationScope.Body>
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                  </ui:ExcelApplicationScope>
                </Sequence>
              </Sequence>
              <FlowStep.Next>
                <FlowStep x:Name="__ReferenceID25">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <av:Point x:Key="ShapeLocation">200,316.5</av:Point>
                      <av:Size x:Key="ShapeSize">200,116</av:Size>
                      <av:PointCollection x:Key="ConnectorLocation">300,432.5 300,475.5</av:PointCollection>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <ui:ExcelApplicationScope Password="{x:Null}" sap2010:Annotation.AnnotationText="读取NC-SAP流水表，并修改SAP项目文本的值（分离出融资合同号）" DisplayName="NC-SAP流水" sap:VirtualizedContainerService.HintSize="200,116" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_1" InstanceCachePeriod="3000" WorkbookPath="[in_Config(&quot;XZB&quot;).ToString+in_Config(&quot;NCSAP&quot;).ToString]">
                    <ui:ExcelApplicationScope.Body>
                      <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                        <ActivityAction.Argument>
                          <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                        </ActivityAction.Argument>
                        <Sequence DisplayName="执行" sap:VirtualizedContainerService.HintSize="618,1075" sap2010:WorkflowViewState.IdRef="Sequence_2">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ui:ExcelReadRange AddHeaders="True" DataTable="[dtSourceTable]" DisplayName="读取范围" sap:VirtualizedContainerService.HintSize="576,59" sap2010:WorkflowViewState.IdRef="ExcelReadRange_1" SheetName="Sheet0">
                            <ui:ExcelReadRange.Range>
                              <InArgument x:TypeArguments="x:String">
                                <Literal x:TypeArguments="x:String" Value="" />
                              </InArgument>
                            </ui:ExcelReadRange.Range>
                          </ui:ExcelReadRange>
                          <ui:FilterDataTable DataTable="[dtSourceTable]" DisplayName="筛选非法数据" FilterRowsMode="Remove" sap:VirtualizedContainerService.HintSize="576,59" sap2010:WorkflowViewState.IdRef="FilterDataTable_12" OutputDataTable="[dtSourceTable]" SelectColumnsMode="Keep">
                            <ui:FilterDataTable.Filters>
                              <scg:List x:TypeArguments="ui:FilterOperationArgument" Capacity="4">
                                <ui:FilterOperationArgument BooleanOperator="And" Operator="CONTAINS">
                                  <ui:FilterOperationArgument.Column>
                                    <InArgument x:TypeArguments="x:String">["SAP项目文本"]</InArgument>
                                  </ui:FilterOperationArgument.Column>
                                  <ui:FilterOperationArgument.Operand>
                                    <InArgument x:TypeArguments="x:String">["-"]</InArgument>
                                  </ui:FilterOperationArgument.Operand>
                                </ui:FilterOperationArgument>
                                <ui:FilterOperationArgument BooleanOperator="And" Operator="NOTCONTAINS">
                                  <ui:FilterOperationArgument.Column>
                                    <InArgument x:TypeArguments="x:String">["SAP项目文本"]</InArgument>
                                  </ui:FilterOperationArgument.Column>
                                  <ui:FilterOperationArgument.Operand>
                                    <InArgument x:TypeArguments="x:String">["001"]</InArgument>
                                  </ui:FilterOperationArgument.Operand>
                                </ui:FilterOperationArgument>
                              </scg:List>
                            </ui:FilterDataTable.Filters>
                            <ui:FilterDataTable.SelectColumns>
                              <scg:List x:TypeArguments="InArgument" Capacity="4">
                                <x:Null />
                              </scg:List>
                            </ui:FilterDataTable.SelectColumns>
                          </ui:FilterDataTable>
                          <ui:AddDataColumn x:TypeArguments="x:Object" AllowDBNull="{x:Null}" AutoIncrement="{x:Null}" Column="{x:Null}" DefaultValue="{x:Null}" MaxLength="{x:Null}" Unique="{x:Null}" ColumnName="放款金额" DataTable="[dtSourceTable]" DisplayName="添加一列放款金额" sap:VirtualizedContainerService.HintSize="576,22" sap2010:WorkflowViewState.IdRef="AddDataColumn`1_1" />
                          <ui:ForEachRow CurrentIndex="{x:Null}" DataTable="[dtSourceTable]" DisplayName="项目文本修改" sap:VirtualizedContainerService.HintSize="576,723" sap2010:WorkflowViewState.IdRef="ForEachRow_14">
                            <ui:ForEachRow.Body>
                              <ActivityAction x:TypeArguments="sd:DataRow">
                                <ActivityAction.Argument>
                                  <DelegateInArgument x:TypeArguments="sd:DataRow" Name="row" />
                                </ActivityAction.Argument>
                                <Sequence DisplayName="正文" sap:VirtualizedContainerService.HintSize="526,574" sap2010:WorkflowViewState.IdRef="Sequence_52">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <If Condition="[not String.IsNullOrEmpty(row(&quot;SAP回款金额&quot;).ToString)]" DisplayName="IF 条件" sap:VirtualizedContainerService.HintSize="484,482" sap2010:WorkflowViewState.IdRef="If_25">
                                    <If.Then>
                                      <Sequence DisplayName="序列" sap:VirtualizedContainerService.HintSize="242,331" sap2010:WorkflowViewState.IdRef="Sequence_72">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <If Condition="[row(&quot;SAP项目文本&quot;).ToString.Contains(&quot;;&quot;) And row(&quot;SAP项目文本&quot;).ToString.Contains(&quot;SFM&quot;)]" DisplayName="包含“；”" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="If_26">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <If.Then>
                                            <Assign DisplayName="分配" sap:VirtualizedContainerService.HintSize="263,61" sap2010:WorkflowViewState.IdRef="Assign_23">
                                              <Assign.To>
                                                <OutArgument x:TypeArguments="x:Object">[row("SAP项目文本")]</OutArgument>
                                              </Assign.To>
                                              <Assign.Value>
                                                <InArgument x:TypeArguments="x:Object">[row("SAP项目文本").ToString.Split(";"c)(1)]</InArgument>
                                              </Assign.Value>
                                            </Assign>
                                          </If.Then>
                                        </If>
                                        <If Condition="[row(&quot;SAP项目文本&quot;).ToString.Contains(&quot;-&quot;) And row(&quot;SAP项目文本&quot;).ToString.Contains(&quot;重工放款&quot;)]" DisplayName="包含“-”" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="If_34">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <If.Then>
                                            <Sequence DisplayName="序列" sap:VirtualizedContainerService.HintSize="376,252" sap2010:WorkflowViewState.IdRef="Sequence_71">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <ui:Matches BuilderPattern="-.*001" DisplayName="匹配以-开头，001结尾的项" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="Matches_1" Input="[row(&quot;SAP项目文本&quot;).ToString]" IsBuilderTabModified="True" Model="[{&quot;Index&quot;:0,&quot;OperationID&quot;:&quot;LIT&quot;,&quot;OperationName&quot;:&quot;Literal&quot;,&quot;OperationValue&quot;:&quot;-.*001&quot;,&quot;QuantifierFirstValue&quot;:&quot;1&quot;,&quot;QuantifierID&quot;:&quot;EXT&quot;,&quot;QuantifierName&quot;:&quot;Exactly&quot;,&quot;QuantifierSecondValue&quot;:null}]" Pattern="-.*001" RegexOption="IgnoreCase" Result="[MatchsReuslt]" />
                                              <Assign DisplayName="分配" sap:VirtualizedContainerService.HintSize="334,61" sap2010:WorkflowViewState.IdRef="Assign_37">
                                                <Assign.To>
                                                  <OutArgument x:TypeArguments="x:Object">[row("SAP项目文本")]</OutArgument>
                                                </Assign.To>
                                                <Assign.Value>
                                                  <InArgument x:TypeArguments="x:String">[MatchsReuslt.ToArray(0).ToString.Split("-"c)(1).Replace("001","").Trim]</InArgument>
                                                </Assign.Value>
                                              </Assign>
                                            </Sequence>
                                          </If.Then>
                                        </If>
                                        <If Condition="[row(&quot;SAP项目文本&quot;).ToString.Contains(&quot; &quot;) And row(&quot;SAP项目文本&quot;).ToString.Contains(&quot;SFM&quot;)]" DisplayName="包含“ ”" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="If_35">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <If.Then>
                                            <Assign DisplayName="分配" sap:VirtualizedContainerService.HintSize="263,61" sap2010:WorkflowViewState.IdRef="Assign_38">
                                              <Assign.To>
                                                <OutArgument x:TypeArguments="x:Object">[row("SAP项目文本")]</OutArgument>
                                              </Assign.To>
                                              <Assign.Value>
                                                <InArgument x:TypeArguments="x:String">[row("SAP项目文本").ToString.Trim.Split(" "c)(1)]</InArgument>
                                              </Assign.Value>
                                            </Assign>
                                          </If.Then>
                                        </If>
                                      </Sequence>
                                    </If.Then>
                                  </If>
                                </Sequence>
                              </ActivityAction>
                            </ui:ForEachRow.Body>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </ui:ForEachRow>
                        </Sequence>
                      </ActivityAction>
                    </ui:ExcelApplicationScope.Body>
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                  </ui:ExcelApplicationScope>
                  <FlowStep.Next>
                    <FlowStep x:Name="__ReferenceID26">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <av:Point x:Key="ShapeLocation">200,475.5</av:Point>
                          <av:Size x:Key="ShapeSize">200,116</av:Size>
                          <av:PointCollection x:Key="ConnectorLocation">300,591.5 300,634.5</av:PointCollection>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ui:ExcelApplicationScope Password="{x:Null}" sap2010:Annotation.AnnotationText="读取放款明细，将借款人与借款额与融资合同号匹配写入字典" DisplayName="放款明细" sap:VirtualizedContainerService.HintSize="200,116" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_2" InstanceCachePeriod="3000" WorkbookPath="[in_Config(&quot;PZB&quot;).ToString+in_Config(&quot;FKMX&quot;).ToString]">
                        <ui:ExcelApplicationScope.Body>
                          <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                            <ActivityAction.Argument>
                              <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                            </ActivityAction.Argument>
                            <Sequence DisplayName="执行" sap:VirtualizedContainerService.HintSize="397,539" sap2010:WorkflowViewState.IdRef="Sequence_4">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <ui:ExcelReadRange AddHeaders="True" DataTable="[dtLoanDetails]" DisplayName="读取范围" sap:VirtualizedContainerService.HintSize="355,59" sap2010:WorkflowViewState.IdRef="ExcelReadRange_2" SheetName="放款明细">
                                <ui:ExcelReadRange.Range>
                                  <InArgument x:TypeArguments="x:String">
                                    <Literal x:TypeArguments="x:String" Value="" />
                                  </InArgument>
                                </ui:ExcelReadRange.Range>
                              </ui:ExcelReadRange>
                              <ui:ForEachRow CurrentIndex="{x:Null}" sap2010:Annotation.AnnotationText="key:融资合同号&#xA;value：{借款人，贷款额}" DataTable="[dtLoanDetails]" DisplayName="遍历放款明细" sap:VirtualizedContainerService.HintSize="355,348" sap2010:WorkflowViewState.IdRef="ForEachRow_2">
                                <ui:ForEachRow.Body>
                                  <ActivityAction x:TypeArguments="sd:DataRow">
                                    <ActivityAction.Argument>
                                      <DelegateInArgument x:TypeArguments="sd:DataRow" Name="row" />
                                    </ActivityAction.Argument>
                                    <Sequence DisplayName="正文" sap:VirtualizedContainerService.HintSize="305,153" sap2010:WorkflowViewState.IdRef="Sequence_7">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <Assign DisplayName="key:融资合同号 value:借款人/承租人" sap:VirtualizedContainerService.HintSize="263,61" sap2010:WorkflowViewState.IdRef="Assign_1">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="s:String[]">[dicLoanDetails(row("银行按揭合同号/融资租赁合同号”).tostring)]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="s:String[]">[{row("合同主体/合同买受人/").ToString,row("贷款额（万元）").ToString}]</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                    </Sequence>
                                  </ActivityAction>
                                </ui:ForEachRow.Body>
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                              </ui:ForEachRow>
                            </Sequence>
                          </ActivityAction>
                        </ui:ExcelApplicationScope.Body>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                      </ui:ExcelApplicationScope>
                      <FlowStep.Next>
                        <FlowStep x:Name="__ReferenceID27">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <av:Point x:Key="ShapeLocation">200,634.5</av:Point>
                              <av:Size x:Key="ShapeSize">200,116</av:Size>
                              <av:PointCollection x:Key="ConnectorLocation">300,750.5 300,793.5</av:PointCollection>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ui:ForEachRow CurrentIndex="{x:Null}" sap2010:Annotation.AnnotationText="写入放款金额，用于配对放款金额与SAP回款金额是否一直（不一致不进行解款）" DataTable="[dtSourceTable]" DisplayName="放款金额写入" sap:VirtualizedContainerService.HintSize="200,116" sap2010:WorkflowViewState.IdRef="ForEachRow_12">
                            <ui:ForEachRow.Body>
                              <ActivityAction x:TypeArguments="sd:DataRow">
                                <ActivityAction.Argument>
                                  <DelegateInArgument x:TypeArguments="sd:DataRow" Name="row" />
                                </ActivityAction.Argument>
                                <Sequence DisplayName="正文" sap:VirtualizedContainerService.HintSize="671,459" sap2010:WorkflowViewState.IdRef="Sequence_45">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <If Condition="[not String.IsNullOrEmpty(row(&quot;SAP回款金额&quot;).ToString) And dicLoanDetails.ContainsKey(row(&quot;SAP项目文本&quot;).ToString)]" DisplayName="IF 条件" sap:VirtualizedContainerService.HintSize="629,367" sap2010:WorkflowViewState.IdRef="If_20">
                                    <If.Then>
                                      <If Condition="[cdbl(cdbl(row(&quot;SAP回款金额&quot;).ToString).ToString(&quot;0.#####&quot;))=cdbl(CDbl(dicLoanDetails(row(&quot;SAP项目文本&quot;).ToString)(1)).ToString(&quot;0.#####&quot;))*10000]" DisplayName="IF 条件" sap:VirtualizedContainerService.HintSize="484,214" sap2010:WorkflowViewState.IdRef="If_19">
                                        <If.Then>
                                          <Assign DisplayName="分配" sap:VirtualizedContainerService.HintSize="263,61" sap2010:WorkflowViewState.IdRef="Assign_19">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="x:Object">[row("放款金额")]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="x:String">[dicLoanDetails(row("SAP项目文本").ToString)(1)]</InArgument>
                                            </Assign.Value>
                                          </Assign>
                                        </If.Then>
                                      </If>
                                    </If.Then>
                                  </If>
                                </Sequence>
                              </ActivityAction>
                            </ui:ForEachRow.Body>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </ui:ForEachRow>
                          <FlowStep.Next>
                            <FlowStep x:Name="__ReferenceID28">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <av:Point x:Key="ShapeLocation">200,793.5</av:Point>
                                  <av:Size x:Key="ShapeSize">200,70</av:Size>
                                  <av:PointCollection x:Key="ConnectorLocation">300,863.5 300,909.5</av:PointCollection>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <Sequence DisplayName="需人工维护表写入" sap:VirtualizedContainerService.HintSize="200,70" sap2010:WorkflowViewState.IdRef="Sequence_61">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <ui:FilterDataTable DataTable="[dtSourceTable]" DisplayName="需维护表" FilterRowsMode="Remove" sap:VirtualizedContainerService.HintSize="805,59" sap2010:WorkflowViewState.IdRef="FilterDataTable_8" OutputDataTable="[dtErrorRow]" SelectColumnsMode="Keep">
                                  <ui:FilterDataTable.Filters>
                                    <scg:List x:TypeArguments="ui:FilterOperationArgument" Capacity="4">
                                      <ui:FilterOperationArgument Operand="{x:Null}" BooleanOperator="And" Operator="NOTEMPTY">
                                        <ui:FilterOperationArgument.Column>
                                          <InArgument x:TypeArguments="x:String">["放款金额"]</InArgument>
                                        </ui:FilterOperationArgument.Column>
                                      </ui:FilterOperationArgument>
                                      <ui:FilterOperationArgument Operand="{x:Null}" BooleanOperator="Or" Operator="EMPTY">
                                        <ui:FilterOperationArgument.Column>
                                          <InArgument x:TypeArguments="x:String">["SAP回款金额"]</InArgument>
                                        </ui:FilterOperationArgument.Column>
                                      </ui:FilterOperationArgument>
                                    </scg:List>
                                  </ui:FilterDataTable.Filters>
                                  <ui:FilterDataTable.SelectColumns>
                                    <scg:List x:TypeArguments="InArgument" Capacity="4">
                                      <x:Null />
                                    </scg:List>
                                  </ui:FilterDataTable.SelectColumns>
                                </ui:FilterDataTable>
                                <ui:AddDataColumn x:TypeArguments="x:Object" AllowDBNull="{x:Null}" AutoIncrement="{x:Null}" Column="{x:Null}" DefaultValue="{x:Null}" MaxLength="{x:Null}" Unique="{x:Null}" ColumnName="备注" DataTable="[dtErrorRow]" DisplayName="添加数据列" sap:VirtualizedContainerService.HintSize="805,22" sap2010:WorkflowViewState.IdRef="AddDataColumn`1_2" />
                                <ui:ForEachRow CurrentIndex="{x:Null}" DataTable="[dtErrorRow]" DisplayName="备注" sap:VirtualizedContainerService.HintSize="805,494" sap2010:WorkflowViewState.IdRef="ForEachRow_17">
                                  <ui:ForEachRow.Body>
                                    <ActivityAction x:TypeArguments="sd:DataRow">
                                      <ActivityAction.Argument>
                                        <DelegateInArgument x:TypeArguments="sd:DataRow" Name="row" />
                                      </ActivityAction.Argument>
                                      <Sequence DisplayName="正文" sap:VirtualizedContainerService.HintSize="755,343" sap2010:WorkflowViewState.IdRef="Sequence_60">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <If Condition="[dicLoanDetails.ContainsKey(row(&quot;SAP项目文本&quot;).ToString)]" DisplayName="IF 条件" sap:VirtualizedContainerService.HintSize="713,251" sap2010:WorkflowViewState.IdRef="If_38">
                                          <If.Then>
                                            <ui:MultipleAssign DisplayName="放款明细未更新" sap:VirtualizedContainerService.HintSize="334,98" sap2010:WorkflowViewState.IdRef="MultipleAssign_32">
                                              <ui:MultipleAssign.AssignOperations>
                                                <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_149">
                                                    <ui:AssignOperation.To>
                                                      <OutArgument x:TypeArguments="x:Object">[row("备注")]</OutArgument>
                                                    </ui:AssignOperation.To>
                                                    <ui:AssignOperation.Value>
                                                      <InArgument x:TypeArguments="x:Object">["放款明细无此融资合同号"]</InArgument>
                                                    </ui:AssignOperation.Value>
                                                  </ui:AssignOperation>
                                                </scg:List>
                                              </ui:MultipleAssign.AssignOperations>
                                            </ui:MultipleAssign>
                                          </If.Then>
                                          <If.Else>
                                            <ui:MultipleAssign DisplayName="金额不一致" sap:VirtualizedContainerService.HintSize="334,98" sap2010:WorkflowViewState.IdRef="MultipleAssign_38">
                                              <ui:MultipleAssign.AssignOperations>
                                                <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_169">
                                                    <ui:AssignOperation.To>
                                                      <OutArgument x:TypeArguments="x:Object">[row("备注")]</OutArgument>
                                                    </ui:AssignOperation.To>
                                                    <ui:AssignOperation.Value>
                                                      <InArgument x:TypeArguments="x:Object">["SAP回款金额与放款明细金额不一致"]</InArgument>
                                                    </ui:AssignOperation.Value>
                                                  </ui:AssignOperation>
                                                </scg:List>
                                              </ui:MultipleAssign.AssignOperations>
                                            </ui:MultipleAssign>
                                          </If.Else>
                                        </If>
                                      </Sequence>
                                    </ActivityAction>
                                  </ui:ForEachRow.Body>
                                </ui:ForEachRow>
                              </Sequence>
                              <FlowStep.Next>
                                <FlowStep x:Name="__ReferenceID29">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <av:Point x:Key="ShapeLocation">200,909.5</av:Point>
                                      <av:Size x:Key="ShapeSize">200,53</av:Size>
                                      <av:PointCollection x:Key="ConnectorLocation">300,962.5 300,1010.5</av:PointCollection>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <ui:FilterDataTable DataTable="[dtSourceTable]" DisplayName="需核销表" FilterRowsMode="Remove" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="FilterDataTable_9" OutputDataTable="[dtSourceTable]" SelectColumnsMode="Keep">
                                    <ui:FilterDataTable.Filters>
                                      <scg:List x:TypeArguments="ui:FilterOperationArgument" Capacity="4">
                                        <ui:FilterOperationArgument Operand="{x:Null}" BooleanOperator="And" Operator="EMPTY">
                                          <ui:FilterOperationArgument.Column>
                                            <InArgument x:TypeArguments="x:String">["放款金额"]</InArgument>
                                          </ui:FilterOperationArgument.Column>
                                        </ui:FilterOperationArgument>
                                        <ui:FilterOperationArgument Operand="{x:Null}" BooleanOperator="Or" Operator="EMPTY">
                                          <ui:FilterOperationArgument.Column>
                                            <InArgument x:TypeArguments="x:String">[“SAP回款金额”]</InArgument>
                                          </ui:FilterOperationArgument.Column>
                                        </ui:FilterOperationArgument>
                                      </scg:List>
                                    </ui:FilterDataTable.Filters>
                                    <ui:FilterDataTable.SelectColumns>
                                      <scg:List x:TypeArguments="InArgument" Capacity="4">
                                        <x:Null />
                                      </scg:List>
                                    </ui:FilterDataTable.SelectColumns>
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                  </ui:FilterDataTable>
                                  <FlowStep.Next>
                                    <FlowStep x:Name="__ReferenceID30">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <av:Point x:Key="ShapeLocation">200,1010.5</av:Point>
                                          <av:Size x:Key="ShapeSize">200,84</av:Size>
                                          <av:PointCollection x:Key="ConnectorLocation">400,1052.5 485,1052.5 485,1130</av:PointCollection>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ui:ExcelApplicationScope Password="{x:Null}" sap2010:Annotation.AnnotationText="读取按揭放款模板表" DisplayName="按揭放款收款单模板" sap:VirtualizedContainerService.HintSize="200,84" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_3" InstanceCachePeriod="3000" WorkbookPath="[in_Config(&quot;PZB&quot;).ToString+in_Config(&quot;AJFKDRMB&quot;).ToString]">
                                        <ui:ExcelApplicationScope.Body>
                                          <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                                            <ActivityAction.Argument>
                                              <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                                            </ActivityAction.Argument>
                                            <Sequence DisplayName="执行" sap:VirtualizedContainerService.HintSize="376,349" sap2010:WorkflowViewState.IdRef="Sequence_5">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <ui:ExcelReadRange AddHeaders="True" DataTable="[dtMainTable]" DisplayName="读取范围" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="ExcelReadRange_3" Range="A2" SheetName="主表" />
                                              <ui:ExcelReadRange AddHeaders="True" DataTable="[dtSubTable]" DisplayName="读取范围" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="ExcelReadRange_4" Range="A2" SheetName="子表" />
                                              <ui:ExcelReadRange AddHeaders="False" DataTable="[dtArchivesTable]" DisplayName="读取范围" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="ExcelReadRange_5" Range="A2" SheetName="档案项" />
                                            </Sequence>
                                          </ActivityAction>
                                        </ui:ExcelApplicationScope.Body>
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                      </ui:ExcelApplicationScope>
                                      <FlowStep.Next>
                                        <FlowStep x:Name="__ReferenceID31">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <av:Point x:Key="ShapeLocation">385,1130</av:Point>
                                              <av:Size x:Key="ShapeSize">200,116</av:Size>
                                              <av:PointCollection x:Key="ConnectorLocation">485,1246 485,1299 489,1299 489,1295 480,1295</av:PointCollection>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <ui:ExcelApplicationScope Password="{x:Null}" sap2010:Annotation.AnnotationText="读取待处理流水清单表的配置页，将客户编码与对方户名匹配写入字典" DisplayName="读取待处理流水清单" sap:VirtualizedContainerService.HintSize="200,116" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_4" InstanceCachePeriod="3000" WorkbookPath="[in_Config(&quot;PZB&quot;).ToString+in_Config(&quot;DCLDGMB&quot;).ToString]">
                                            <ui:ExcelApplicationScope.Body>
                                              <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                                                <ActivityAction.Argument>
                                                  <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                                                </ActivityAction.Argument>
                                                <Sequence DisplayName="执行" sap:VirtualizedContainerService.HintSize="655,866" sap2010:WorkflowViewState.IdRef="Sequence_9">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <ui:ExcelReadRange AddHeaders="True" DataTable="[dtConfigTable]" DisplayName="读取配置映射" sap:VirtualizedContainerService.HintSize="613,59" sap2010:WorkflowViewState.IdRef="ExcelReadRange_6" SheetName="配置表">
                                                    <ui:ExcelReadRange.Range>
                                                      <InArgument x:TypeArguments="x:String">
                                                        <Literal x:TypeArguments="x:String" Value="" />
                                                      </InArgument>
                                                    </ui:ExcelReadRange.Range>
                                                  </ui:ExcelReadRange>
                                                  <ui:ForEachRow CurrentIndex="{x:Null}" sap2010:Annotation.AnnotationText="将待处理流水清单配置页的客商关系写入字典" DataTable="[dtConfigTable]" DisplayName="客户明细信息写入字典" sap:VirtualizedContainerService.HintSize="613,675" sap2010:WorkflowViewState.IdRef="ForEachRow_3">
                                                    <ui:ForEachRow.Body>
                                                      <ActivityAction x:TypeArguments="sd:DataRow">
                                                        <ActivityAction.Argument>
                                                          <DelegateInArgument x:TypeArguments="sd:DataRow" Name="row" />
                                                        </ActivityAction.Argument>
                                                        <Sequence DisplayName="正文" sap:VirtualizedContainerService.HintSize="563,495" sap2010:WorkflowViewState.IdRef="Sequence_8">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <If Condition="[Not String.IsNullOrWhiteSpace(row(&quot;银行流水号&quot;).ToString)]" DisplayName="判空" sap:VirtualizedContainerService.HintSize="521,403" sap2010:WorkflowViewState.IdRef="If_1">
                                                            <If.Then>
                                                              <Sequence DisplayName="序列" sap:VirtualizedContainerService.HintSize="376,252" sap2010:WorkflowViewState.IdRef="Sequence_53">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <ui:MultipleAssign DisplayName="多重分配" sap:VirtualizedContainerService.HintSize="334,160" sap2010:WorkflowViewState.IdRef="MultipleAssign_27">
                                                                  <ui:MultipleAssign.AssignOperations>
                                                                    <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_128">
                                                                        <ui:AssignOperation.To>
                                                                          <OutArgument x:TypeArguments="s:String[]">[dicPendingTask(row("银行流水号").ToString)]</OutArgument>
                                                                        </ui:AssignOperation.To>
                                                                        <ui:AssignOperation.Value>
                                                                          <InArgument x:TypeArguments="s:String[]">[{row("客户/客商").ToString,row("客户编码").ToString}]</InArgument>
                                                                        </ui:AssignOperation.Value>
                                                                      </ui:AssignOperation>
                                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_129">
                                                                        <ui:AssignOperation.To>
                                                                          <OutArgument x:TypeArguments="s:String[]">[dicPendingTask(row("客户编码").ToString)]</OutArgument>
                                                                        </ui:AssignOperation.To>
                                                                        <ui:AssignOperation.Value>
                                                                          <InArgument x:TypeArguments="s:String[]">[{row("客户/客商").ToString}]</InArgument>
                                                                        </ui:AssignOperation.Value>
                                                                      </ui:AssignOperation>
                                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_180">
                                                                        <ui:AssignOperation.To>
                                                                          <OutArgument x:TypeArguments="x:String">[dicCollectsPending(row("客户/客商").ToString)]</OutArgument>
                                                                        </ui:AssignOperation.To>
                                                                        <ui:AssignOperation.Value>
                                                                          <InArgument x:TypeArguments="x:String">[row("客户编码").ToString]</InArgument>
                                                                        </ui:AssignOperation.Value>
                                                                      </ui:AssignOperation>
                                                                    </scg:List>
                                                                  </ui:MultipleAssign.AssignOperations>
                                                                </ui:MultipleAssign>
                                                              </Sequence>
                                                            </If.Then>
                                                          </If>
                                                        </Sequence>
                                                      </ActivityAction>
                                                    </ui:ForEachRow.Body>
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                  </ui:ForEachRow>
                                                </Sequence>
                                              </ActivityAction>
                                            </ui:ExcelApplicationScope.Body>
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                          </ui:ExcelApplicationScope>
                                          <FlowStep.Next>
                                            <FlowStep x:Name="__ReferenceID32">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <av:Point x:Key="ShapeLocation">380,1295</av:Point>
                                                  <av:Size x:Key="ShapeSize">200,150</av:Size>
                                                  <av:PointCollection x:Key="ConnectorLocation">480,1445 480,1488</av:PointCollection>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <ui:ExcelApplicationScope Password="{x:Null}" sap2010:Annotation.AnnotationText="读取主机应收表，筛选掉空行与重复表头，用主机应收单据表的主机编码列匹配配置字典中销售责任人与销售订单号，客商写入字典" DisplayName="主机应收" sap:VirtualizedContainerService.HintSize="200,150" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_10" InstanceCachePeriod="3000" WorkbookPath="[in_Config(&quot;PZB&quot;).ToString+in_Config(&quot;ZJYSDJ&quot;).ToString]">
                                                <ui:ExcelApplicationScope.Body>
                                                  <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                                                    <ActivityAction.Argument>
                                                      <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                                                    </ActivityAction.Argument>
                                                    <Sequence DisplayName="执行" sap:VirtualizedContainerService.HintSize="397,669" sap2010:WorkflowViewState.IdRef="Sequence_36">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ui:ExcelReadRange AddHeaders="True" DataTable="[dtReceivable]" DisplayName="读取主机应收表" sap:VirtualizedContainerService.HintSize="355,59" sap2010:WorkflowViewState.IdRef="ExcelReadRange_11" SheetName="新的工作表">
                                                        <ui:ExcelReadRange.Range>
                                                          <InArgument x:TypeArguments="x:String">
                                                            <Literal x:TypeArguments="x:String" Value="" />
                                                          </InArgument>
                                                        </ui:ExcelReadRange.Range>
                                                      </ui:ExcelReadRange>
                                                      <ui:FilterDataTable sap2010:Annotation.AnnotationText="" DataTable="[dtReceivable]" DisplayName="删除空列与重复的表头" FilterRowsMode="Remove" sap:VirtualizedContainerService.HintSize="355,90" sap2010:WorkflowViewState.IdRef="FilterDataTable_6" OutputDataTable="[dtReceivable]" SelectColumnsMode="Keep">
                                                        <ui:FilterDataTable.Filters>
                                                          <scg:List x:TypeArguments="ui:FilterOperationArgument" Capacity="4">
                                                            <ui:FilterOperationArgument Operand="{x:Null}" BooleanOperator="And" Operator="EMPTY">
                                                              <ui:FilterOperationArgument.Column>
                                                                <InArgument x:TypeArguments="x:String">["单位"]</InArgument>
                                                              </ui:FilterOperationArgument.Column>
                                                            </ui:FilterOperationArgument>
                                                            <ui:FilterOperationArgument BooleanOperator="Or" Operator="EQ">
                                                              <ui:FilterOperationArgument.Column>
                                                                <InArgument x:TypeArguments="x:String">["单位"]</InArgument>
                                                              </ui:FilterOperationArgument.Column>
                                                              <ui:FilterOperationArgument.Operand>
                                                                <InArgument x:TypeArguments="x:String">["单位"]</InArgument>
                                                              </ui:FilterOperationArgument.Operand>
                                                            </ui:FilterOperationArgument>
                                                            <ui:FilterOperationArgument BooleanOperator="Or" Operator="EQ">
                                                              <ui:FilterOperationArgument.Column>
                                                                <InArgument x:TypeArguments="x:String">["单位"]</InArgument>
                                                              </ui:FilterOperationArgument.Column>
                                                              <ui:FilterOperationArgument.Operand>
                                                                <InArgument x:TypeArguments="x:String">[""]</InArgument>
                                                              </ui:FilterOperationArgument.Operand>
                                                            </ui:FilterOperationArgument>
                                                          </scg:List>
                                                        </ui:FilterDataTable.Filters>
                                                        <ui:FilterDataTable.SelectColumns>
                                                          <scg:List x:TypeArguments="InArgument" Capacity="4">
                                                            <x:Null />
                                                          </scg:List>
                                                        </ui:FilterDataTable.SelectColumns>
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                      </ui:FilterDataTable>
                                                      <ui:ForEachRow CurrentIndex="{x:Null}" sap2010:Annotation.AnnotationText="用主机应收单据表的主机编码列匹配配置字典中销售责任人与销售订单号，客商写入字典" DataTable="[dtReceivable]" DisplayName="写入客户与客户编码" sap:VirtualizedContainerService.HintSize="355,348" sap2010:WorkflowViewState.IdRef="ForEachRow_10">
                                                        <ui:ForEachRow.Body>
                                                          <ActivityAction x:TypeArguments="sd:DataRow">
                                                            <ActivityAction.Argument>
                                                              <DelegateInArgument x:TypeArguments="sd:DataRow" Name="row" />
                                                            </ActivityAction.Argument>
                                                            <Sequence DisplayName="正文" sap:VirtualizedContainerService.HintSize="305,153" sap2010:WorkflowViewState.IdRef="Sequence_35">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <Assign DisplayName="主机应收字典" sap:VirtualizedContainerService.HintSize="263,61" sap2010:WorkflowViewState.IdRef="Assign_12">
                                                                <Assign.To>
                                                                  <OutArgument x:TypeArguments="s:String[]">[dicReceivable(row("主机编码").ToString)]</OutArgument>
                                                                </Assign.To>
                                                                <Assign.Value>
                                                                  <InArgument x:TypeArguments="s:String[]">[{row("销售责任人").ToString,row("销售订单号").ToString,row("客商").ToString}]</InArgument>
                                                                </Assign.Value>
                                                              </Assign>
                                                            </Sequence>
                                                          </ActivityAction>
                                                        </ui:ForEachRow.Body>
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                      </ui:ForEachRow>
                                                    </Sequence>
                                                  </ActivityAction>
                                                </ui:ExcelApplicationScope.Body>
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                              </ui:ExcelApplicationScope>
                                              <FlowStep.Next>
                                                <FlowStep x:Name="__ReferenceID33">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <av:Point x:Key="ShapeLocation">380,1488</av:Point>
                                                      <av:Size x:Key="ShapeSize">200,84</av:Size>
                                                      <av:PointCollection x:Key="ConnectorLocation">480,1572 480,1618</av:PointCollection>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <ui:ForEachRow CurrentIndex="{x:Null}" sap2010:Annotation.AnnotationText="主表填充" DataTable="[dtSourceTable]" DisplayName="遍历NC-SAP流水表" sap:VirtualizedContainerService.HintSize="200,84" sap2010:WorkflowViewState.IdRef="ForEachRow_1">
                                                    <ui:ForEachRow.Body>
                                                      <ActivityAction x:TypeArguments="sd:DataRow">
                                                        <ActivityAction.Argument>
                                                          <DelegateInArgument x:TypeArguments="sd:DataRow" Name="row" />
                                                        </ActivityAction.Argument>
                                                        <Sequence DisplayName="正文" sap:VirtualizedContainerService.HintSize="1343,1347" sap2010:WorkflowViewState.IdRef="Sequence_6">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <Flowchart DisplayName="主表" sap:VirtualizedContainerService.HintSize="1301,1255" sap2010:WorkflowViewState.IdRef="Flowchart_4">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                <av:Point x:Key="ShapeLocation">640,2.5</av:Point>
                                                                <av:Size x:Key="ShapeSize">60,75</av:Size>
                                                                <av:PointCollection x:Key="ConnectorLocation">670,77.5 670,127.5</av:PointCollection>
                                                                <x:Double x:Key="Width">1267</x:Double>
                                                                <x:Double x:Key="Height">1219.38</x:Double>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <Flowchart.StartNode>
                                                              <x:Reference>__ReferenceID14</x:Reference>
                                                            </Flowchart.StartNode>
                                                            <FlowDecision x:Name="__ReferenceID1" Condition="[dtRepaymentSchedule.Select(&quot;客户名称='&quot; + dicPendingTask(dicLoanDetails(row(&quot;SAP项目文本&quot;).ToString)(0))(0)+&quot;'&quot;).Length &gt; 0]" DisplayName="判断此客户是否有还款计划" sap:VirtualizedContainerService.HintSize="150,87" sap2010:WorkflowViewState.IdRef="FlowDecision_7">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  <av:Point x:Key="ShapeLocation">390,247.5</av:Point>
                                                                  <av:Size x:Key="ShapeSize">150,87</av:Size>
                                                                  <av:PointCollection x:Key="TrueConnector">390,291 330,291</av:PointCollection>
                                                                  <av:PointCollection x:Key="FalseConnector">540,291 690,291 690,370</av:PointCollection>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <FlowDecision.True>
                                                                <FlowStep x:Name="__ReferenceID13">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <av:Point x:Key="ShapeLocation">67,261</av:Point>
                                                                      <av:Size x:Key="ShapeSize">263,61</av:Size>
                                                                      <av:PointCollection x:Key="ConnectorLocation">198.5,321 198.5,399</av:PointCollection>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <Assign DisplayName="分配" sap:VirtualizedContainerService.HintSize="263,61" sap2010:WorkflowViewState.IdRef="Assign_36">
                                                                    <Assign.To>
                                                                      <OutArgument x:TypeArguments="x:Double">[dblToltal]</OutArgument>
                                                                    </Assign.To>
                                                                    <Assign.Value>
                                                                      <InArgument x:TypeArguments="x:Double">0</InArgument>
                                                                    </Assign.Value>
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                  </Assign>
                                                                  <FlowStep.Next>
                                                                    <FlowStep x:Name="__ReferenceID9">
                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                          <av:Point x:Key="ShapeLocation">67,399</av:Point>
                                                                          <av:Size x:Key="ShapeSize">263,124</av:Size>
                                                                          <av:PointCollection x:Key="ConnectorLocation">198.5,523 198.5,563</av:PointCollection>
                                                                        </scg:Dictionary>
                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                      <Assign sap2010:Annotation.AnnotationText="客户未收明细表中逾期款中查询”客户名称“与遍历到的当前行“客户”列对应的数据行按应还款时间升序" DisplayName="查询匹配行" sap:VirtualizedContainerService.HintSize="263,124" sap2010:WorkflowViewState.IdRef="Assign_33">
                                                                        <Assign.To>
                                                                          <OutArgument x:TypeArguments="sd:DataTable">[dtOverduePending]</OutArgument>
                                                                        </Assign.To>
                                                                        <Assign.Value>
                                                                          <InArgument x:TypeArguments="sd:DataTable" xml:space="preserve">[dtRepaymentSchedule.Select("客户名称='" +  dicPendingTask(dicLoanDetails(row("SAP项目文本").ToString)(0))(0) +"'","应还款时间 ASC").CopyToDataTable]</InArgument>
                                                                        </Assign.Value>
                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                          </scg:Dictionary>
                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                      </Assign>
                                                                      <FlowStep.Next>
                                                                        <FlowStep x:Name="__ReferenceID8">
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <av:Point x:Key="ShapeLocation">98.5,563</av:Point>
                                                                              <av:Size x:Key="ShapeSize">200,99</av:Size>
                                                                              <av:PointCollection x:Key="ConnectorLocation">298.5,612.5 328.5,612.5 328.5,609.5 348.5,609.5</av:PointCollection>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                          <ui:ForEachRow sap2010:Annotation.AnnotationText="遍历筛选后的还款计划，计算总金额是否与收款金额一致" CurrentIndex="[iCount2]" DataTable="[dtOverduePending]" DisplayName="对于每一个行" sap:VirtualizedContainerService.HintSize="200,99" sap2010:WorkflowViewState.IdRef="ForEachRow_18">
                                                                            <ui:ForEachRow.Body>
                                                                              <ActivityAction x:TypeArguments="sd:DataRow">
                                                                                <ActivityAction.Argument>
                                                                                  <DelegateInArgument x:TypeArguments="sd:DataRow" Name="row2" />
                                                                                </ActivityAction.Argument>
                                                                                <Sequence DisplayName="正文" sap:VirtualizedContainerService.HintSize="380,190" sap2010:WorkflowViewState.IdRef="Sequence_65">
                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                    </scg:Dictionary>
                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                  <ui:MultipleAssign DisplayName="多重分配" sap:VirtualizedContainerService.HintSize="338,98" sap2010:WorkflowViewState.IdRef="MultipleAssign_37">
                                                                                    <ui:MultipleAssign.AssignOperations>
                                                                                      <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_168">
                                                                                          <ui:AssignOperation.To>
                                                                                            <OutArgument x:TypeArguments="x:Double">[dblToltal]</OutArgument>
                                                                                          </ui:AssignOperation.To>
                                                                                          <ui:AssignOperation.Value>
                                                                                            <InArgument x:TypeArguments="x:Double">[dblToltal+cdbl(row2("未解款金额").ToString)]</InArgument>
                                                                                          </ui:AssignOperation.Value>
                                                                                        </ui:AssignOperation>
                                                                                      </scg:List>
                                                                                    </ui:MultipleAssign.AssignOperations>
                                                                                  </ui:MultipleAssign>
                                                                                </Sequence>
                                                                              </ActivityAction>
                                                                            </ui:ForEachRow.Body>
                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                              </scg:Dictionary>
                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                          </ui:ForEachRow>
                                                                          <FlowStep.Next>
                                                                            <FlowStep x:Name="__ReferenceID10">
                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                  <av:Point x:Key="ShapeLocation">348.5,598.5</av:Point>
                                                                                  <av:Size x:Key="ShapeSize">200,22</av:Size>
                                                                                  <av:PointCollection x:Key="ConnectorLocation">548.5,609.5 583,609.5 583,672</av:PointCollection>
                                                                                </scg:Dictionary>
                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                              <ui:ClearDataTable DataTable="[dtOverduePending]" DisplayName="清除数据表" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="ClearDataTable_6" />
                                                                              <FlowStep.Next>
                                                                                <FlowDecision x:Name="__ReferenceID11" Condition="[cdbl(row(&quot;SAP回款金额&quot;).ToString)&lt;=dblToltal]" DisplayName="打款=还款总额？" sap:VirtualizedContainerService.HintSize="99,87" sap2010:WorkflowViewState.IdRef="FlowDecision_13">
                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                      <av:Point x:Key="ShapeLocation">533.5,672</av:Point>
                                                                                      <av:Size x:Key="ShapeSize">99,87</av:Size>
                                                                                      <av:PointCollection x:Key="FalseConnector">632.5,715.5 713.5,715.5</av:PointCollection>
                                                                                      <av:PointCollection x:Key="TrueConnector">533.5,715.5 340,715.5 340,826.5</av:PointCollection>
                                                                                    </scg:Dictionary>
                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                  <FlowDecision.True>
                                                                                    <FlowDecision x:Name="__ReferenceID2" Condition="[(iCount+1)&lt;10]" DisplayName="编号判断" sap:VirtualizedContainerService.HintSize="70,87" sap2010:WorkflowViewState.IdRef="FlowDecision_10">
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                          <av:Point x:Key="ShapeLocation">305,826.5</av:Point>
                                                                                          <av:Size x:Key="ShapeSize">70,87</av:Size>
                                                                                          <av:PointCollection x:Key="TrueConnector">305,870 131.5,870 131.5,969.5</av:PointCollection>
                                                                                          <av:PointCollection x:Key="FalseConnector">375,870 556.5,870 556.5,969.5</av:PointCollection>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                      <FlowDecision.True>
                                                                                        <FlowStep x:Name="__ReferenceID3">
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <av:Point x:Key="ShapeLocation">0,969.5</av:Point>
                                                                                              <av:Size x:Key="ShapeSize">263,61</av:Size>
                                                                                              <av:PointCollection x:Key="ConnectorLocation">131.5,1030.5 131.5,1120.88 240,1120.88</av:PointCollection>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                          <Assign DisplayName="1-9" sap:VirtualizedContainerService.HintSize="263,61" sap2010:WorkflowViewState.IdRef="Assign_31">
                                                                                            <Assign.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[strSerialNumber]</OutArgument>
                                                                                            </Assign.To>
                                                                                            <Assign.Value>
                                                                                              <InArgument x:TypeArguments="x:String">["0"+(iCount+1).ToString]</InArgument>
                                                                                            </Assign.Value>
                                                                                          </Assign>
                                                                                          <FlowStep.Next>
                                                                                            <FlowStep x:Name="__ReferenceID0">
                                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                  <av:Point x:Key="ShapeLocation">240,1094.38</av:Point>
                                                                                                  <av:Size x:Key="ShapeSize">200,53</av:Size>
                                                                                                  <av:PointCollection x:Key="ConnectorLocation">340,1147.38 340,1197.38</av:PointCollection>
                                                                                                </scg:Dictionary>
                                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                                              <ui:MultipleAssign DisplayName="主表" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="MultipleAssign_21">
                                                                                                <ui:MultipleAssign.AssignOperations>
                                                                                                  <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                                                                                                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_97">
                                                                                                      <ui:AssignOperation.To>
                                                                                                        <OutArgument x:TypeArguments="x:String">[arrMainTable(0)]</OutArgument>
                                                                                                      </ui:AssignOperation.To>
                                                                                                      <ui:AssignOperation.Value>
                                                                                                        <InArgument x:TypeArguments="x:String">[strSerialNumber]</InArgument>
                                                                                                      </ui:AssignOperation.Value>
                                                                                                    </ui:AssignOperation>
                                                                                                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_98">
                                                                                                      <ui:AssignOperation.To>
                                                                                                        <OutArgument x:TypeArguments="x:String">[arrMainTable(1)]</OutArgument>
                                                                                                      </ui:AssignOperation.To>
                                                                                                      <ui:AssignOperation.Value>
                                                                                                        <InArgument x:TypeArguments="x:String">06</InArgument>
                                                                                                      </ui:AssignOperation.Value>
                                                                                                    </ui:AssignOperation>
                                                                                                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_99">
                                                                                                      <ui:AssignOperation.To>
                                                                                                        <OutArgument x:TypeArguments="x:String">[arrMainTable(2)]</OutArgument>
                                                                                                      </ui:AssignOperation.To>
                                                                                                      <ui:AssignOperation.Value>
                                                                                                        <InArgument x:TypeArguments="x:String">[cdate(row("SAP业务日期")).ToString("yyyy-MM-dd")]</InArgument>
                                                                                                      </ui:AssignOperation.Value>
                                                                                                    </ui:AssignOperation>
                                                                                                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_100">
                                                                                                      <ui:AssignOperation.To>
                                                                                                        <OutArgument x:TypeArguments="x:String">[arrMainTable(3)]</OutArgument>
                                                                                                      </ui:AssignOperation.To>
                                                                                                      <ui:AssignOperation.Value>
                                                                                                        <InArgument x:TypeArguments="x:String">01</InArgument>
                                                                                                      </ui:AssignOperation.Value>
                                                                                                    </ui:AssignOperation>
                                                                                                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_101">
                                                                                                      <ui:AssignOperation.To>
                                                                                                        <OutArgument x:TypeArguments="x:String">[arrMainTable(4)]</OutArgument>
                                                                                                      </ui:AssignOperation.To>
                                                                                                      <ui:AssignOperation.Value>
                                                                                                        <InArgument x:TypeArguments="x:String">[dicPendingTask(dicLoanDetails(row("SAP项目文本").ToString)(0))(1)]</InArgument>
                                                                                                      </ui:AssignOperation.Value>
                                                                                                    </ui:AssignOperation>
                                                                                                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_102">
                                                                                                      <ui:AssignOperation.To>
                                                                                                        <OutArgument x:TypeArguments="x:String">[arrMainTable(5)]</OutArgument>
                                                                                                      </ui:AssignOperation.To>
                                                                                                      <ui:AssignOperation.Value>
                                                                                                        <InArgument x:TypeArguments="x:String">[row("SAP回款金额").ToString]</InArgument>
                                                                                                      </ui:AssignOperation.Value>
                                                                                                    </ui:AssignOperation>
                                                                                                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_148">
                                                                                                      <ui:AssignOperation.To>
                                                                                                        <OutArgument x:TypeArguments="x:Int32">[iCount]</OutArgument>
                                                                                                      </ui:AssignOperation.To>
                                                                                                      <ui:AssignOperation.Value>
                                                                                                        <InArgument x:TypeArguments="x:Int32">[iCount+1]</InArgument>
                                                                                                      </ui:AssignOperation.Value>
                                                                                                    </ui:AssignOperation>
                                                                                                  </scg:List>
                                                                                                </ui:MultipleAssign.AssignOperations>
                                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                  </scg:Dictionary>
                                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                              </ui:MultipleAssign>
                                                                                              <FlowStep.Next>
                                                                                                <FlowStep x:Name="__ReferenceID5">
                                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                      <av:Point x:Key="ShapeLocation">240,1197.38</av:Point>
                                                                                                      <av:Size x:Key="ShapeSize">200,22</av:Size>
                                                                                                    </scg:Dictionary>
                                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                                  <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[arrMainTable]" DataTable="[dtMainTable]" DisplayName="添加数据行" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddDataRow_14">
                                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                      </scg:Dictionary>
                                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                                  </ui:AddDataRow>
                                                                                                </FlowStep>
                                                                                              </FlowStep.Next>
                                                                                            </FlowStep>
                                                                                          </FlowStep.Next>
                                                                                        </FlowStep>
                                                                                      </FlowDecision.True>
                                                                                      <FlowDecision.False>
                                                                                        <FlowStep x:Name="__ReferenceID4">
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <av:Point x:Key="ShapeLocation">425,969.5</av:Point>
                                                                                              <av:Size x:Key="ShapeSize">263,61</av:Size>
                                                                                              <av:PointCollection x:Key="ConnectorLocation">556.5,1030.5 556.5,1120.88 440,1120.88</av:PointCollection>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                          <Assign DisplayName="大于9" sap:VirtualizedContainerService.HintSize="263,61" sap2010:WorkflowViewState.IdRef="Assign_32">
                                                                                            <Assign.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[strSerialNumber]</OutArgument>
                                                                                            </Assign.To>
                                                                                            <Assign.Value>
                                                                                              <InArgument x:TypeArguments="x:String">[(iCount+1).ToString]</InArgument>
                                                                                            </Assign.Value>
                                                                                          </Assign>
                                                                                          <FlowStep.Next>
                                                                                            <x:Reference>__ReferenceID0</x:Reference>
                                                                                          </FlowStep.Next>
                                                                                        </FlowStep>
                                                                                      </FlowDecision.False>
                                                                                    </FlowDecision>
                                                                                  </FlowDecision.True>
                                                                                  <FlowDecision.False>
                                                                                    <FlowStep x:Name="__ReferenceID12">
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <av:Point x:Key="ShapeLocation">713.5,704.5</av:Point>
                                                                                          <av:Size x:Key="ShapeSize">200,22</av:Size>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                      <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[row.ItemArray.Concat({&quot;打款金额与还款金额总额不匹配&quot;}).ToArray]" DataTable="[dtErrorRow]" DisplayName="添加数据行" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddDataRow_22">
                                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                          </scg:Dictionary>
                                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                                      </ui:AddDataRow>
                                                                                    </FlowStep>
                                                                                  </FlowDecision.False>
                                                                                </FlowDecision>
                                                                              </FlowStep.Next>
                                                                            </FlowStep>
                                                                          </FlowStep.Next>
                                                                        </FlowStep>
                                                                      </FlowStep.Next>
                                                                    </FlowStep>
                                                                  </FlowStep.Next>
                                                                </FlowStep>
                                                              </FlowDecision.True>
                                                              <FlowDecision.False>
                                                                <FlowStep x:Name="__ReferenceID6">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <av:Point x:Key="ShapeLocation">590,370</av:Point>
                                                                      <av:Size x:Key="ShapeSize">200,22</av:Size>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <ui:Continue DisplayName="继续" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Continue_1">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                  </ui:Continue>
                                                                </FlowStep>
                                                              </FlowDecision.False>
                                                            </FlowDecision>
                                                            <FlowDecision x:Name="__ReferenceID14" Condition="[dicPendingTask.ContainsKey(dicLoanDetails(row(&quot;SAP项目文本&quot;).ToString)(0))]" DisplayName="判断此客户是否存在在配置页" sap:VirtualizedContainerService.HintSize="160,87" sap2010:WorkflowViewState.IdRef="FlowDecision_8" True="{x:Reference __ReferenceID1}">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  <av:Point x:Key="ShapeLocation">590,127.5</av:Point>
                                                                  <av:Size x:Key="ShapeSize">160,87</av:Size>
                                                                  <av:PointCollection x:Key="TrueConnector">590,171 465,171 465,247.5</av:PointCollection>
                                                                  <av:PointCollection x:Key="FalseConnector">750,171 910,171 910,220</av:PointCollection>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <FlowDecision.False>
                                                                <FlowStep x:Name="__ReferenceID7">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <av:Point x:Key="ShapeLocation">810,220</av:Point>
                                                                      <av:Size x:Key="ShapeSize">200,22</av:Size>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[row.ItemArray.Concat({&quot;客户对应对应关系配置表无此客户编码&quot;}).ToArray]" DataTable="[dtErrorRow]" DisplayName="添加数据行" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddDataRow_19">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                  </ui:AddDataRow>
                                                                </FlowStep>
                                                              </FlowDecision.False>
                                                            </FlowDecision>
                                                            <x:Reference>__ReferenceID2</x:Reference>
                                                            <x:Reference>__ReferenceID3</x:Reference>
                                                            <x:Reference>__ReferenceID4</x:Reference>
                                                            <x:Reference>__ReferenceID0</x:Reference>
                                                            <x:Reference>__ReferenceID5</x:Reference>
                                                            <x:Reference>__ReferenceID6</x:Reference>
                                                            <x:Reference>__ReferenceID7</x:Reference>
                                                            <x:Reference>__ReferenceID8</x:Reference>
                                                            <x:Reference>__ReferenceID9</x:Reference>
                                                            <x:Reference>__ReferenceID10</x:Reference>
                                                            <x:Reference>__ReferenceID11</x:Reference>
                                                            <x:Reference>__ReferenceID12</x:Reference>
                                                            <x:Reference>__ReferenceID13</x:Reference>
                                                          </Flowchart>
                                                        </Sequence>
                                                      </ActivityAction>
                                                    </ui:ForEachRow.Body>
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                  </ui:ForEachRow>
                                                  <FlowStep.Next>
                                                    <FlowStep x:Name="__ReferenceID34">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <av:Point x:Key="ShapeLocation">380,1618</av:Point>
                                                          <av:Size x:Key="ShapeSize">200,84</av:Size>
                                                          <av:PointCollection x:Key="ConnectorLocation">480,1702 480,1748</av:PointCollection>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ui:ForEachRow CurrentIndex="{x:Null}" sap2010:Annotation.AnnotationText="子表填充" DataTable="[dtMainTable]" DisplayName="遍历主表" sap:VirtualizedContainerService.HintSize="200,84" sap2010:WorkflowViewState.IdRef="ForEachRow_16">
                                                        <ui:ForEachRow.Body>
                                                          <ActivityAction x:TypeArguments="sd:DataRow">
                                                            <ActivityAction.Argument>
                                                              <DelegateInArgument x:TypeArguments="sd:DataRow" Name="row" />
                                                            </ActivityAction.Argument>
                                                            <Sequence DisplayName="正文" sap:VirtualizedContainerService.HintSize="1079,2737" sap2010:WorkflowViewState.IdRef="Sequence_58">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <Sequence DisplayName="子表" sap:VirtualizedContainerService.HintSize="1037,2645" sap2010:WorkflowViewState.IdRef="Sequence_57">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <If Condition="[row(&quot;到账金额&quot;).ToString.Equals(&quot;数字&quot;)]" DisplayName="IF 条件" sap:VirtualizedContainerService.HintSize="995,213" sap2010:WorkflowViewState.IdRef="If_32">
                                                                  <If.Then>
                                                                    <ui:Continue DisplayName="继续" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Continue_2" />
                                                                  </If.Then>
                                                                </If>
                                                                <ui:SortDataTable ColumnIndex="{x:Null}" DataColumn="{x:Null}" sap2010:Annotation.AnnotationText="待处理流水清单根据SAP项目文本进行排序（将同SAP项目文本的行挨在一起）" ColumnName="SAP项目文本" DataTable="[dtSourceTable]" DisplayName="排序数据表" sap:VirtualizedContainerService.HintSize="995,85" sap2010:WorkflowViewState.IdRef="SortDataTable_3" Order="Ascending" OutputDataTable="[dtSourceTable]" SortOrder="Ascending">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                </ui:SortDataTable>
                                                                <Sequence DisplayName="还款计划匹配" sap:VirtualizedContainerService.HintSize="995,2175" sap2010:WorkflowViewState.IdRef="Sequence_56">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <Assign DisplayName="记录当行的一次拆分金额" sap:VirtualizedContainerService.HintSize="953,61" sap2010:WorkflowViewState.IdRef="Assign_25">
                                                                    <Assign.To>
                                                                      <OutArgument x:TypeArguments="x:Double">[dblPayment]</OutArgument>
                                                                    </Assign.To>
                                                                    <Assign.Value>
                                                                      <InArgument x:TypeArguments="x:Double">[cdbl(row("到账金额").ToString)]</InArgument>
                                                                    </Assign.Value>
                                                                  </Assign>
                                                                  <If sap2010:Annotation.AnnotationText="查询还款计划中是否有此客户，没有就跳过当前客户，有就讲此客户的所有行提取出来" Condition="[dtRepaymentSchedule.Select(&quot;客户名称='&quot; +  dicPendingTask(row(&quot;客户档案&quot;).ToString)(0) +&quot;'&quot;).Length &gt; 0]" DisplayName="查询客户" sap:VirtualizedContainerService.HintSize="953,1982" sap2010:WorkflowViewState.IdRef="If_29">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <If.Then>
                                                                      <Sequence DisplayName="序列" sap:VirtualizedContainerService.HintSize="808,1798" sap2010:WorkflowViewState.IdRef="Sequence_55">
                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                          </scg:Dictionary>
                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                        <Assign sap2010:Annotation.AnnotationText="客户未收明细表中逾期款中查询”客户名称“与遍历到的当前行“客户”列对应的数据行按应还款时间升序" DisplayName="查询匹配行" sap:VirtualizedContainerService.HintSize="766,124" sap2010:WorkflowViewState.IdRef="Assign_28">
                                                                          <Assign.To>
                                                                            <OutArgument x:TypeArguments="sd:DataTable">[dtOverduePending]</OutArgument>
                                                                          </Assign.To>
                                                                          <Assign.Value>
                                                                            <InArgument x:TypeArguments="sd:DataTable">[dtRepaymentSchedule.Select("客户名称='" + dicPendingTask(row("客户档案").ToString)(0) +"'","应还款时间 ASC").CopyToDataTable]</InArgument>
                                                                          </Assign.Value>
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                        </Assign>
                                                                        <ui:ForEachRow sap2010:Annotation.AnnotationText="遍历筛选后的还款计划" CurrentIndex="[iCount2]" DataTable="[dtOverduePending]" DisplayName="对于每一个行" sap:VirtualizedContainerService.HintSize="766,1480" sap2010:WorkflowViewState.IdRef="ForEachRow_15">
                                                                          <ui:ForEachRow.Body>
                                                                            <ActivityAction x:TypeArguments="sd:DataRow">
                                                                              <ActivityAction.Argument>
                                                                                <DelegateInArgument x:TypeArguments="sd:DataRow" Name="row2" />
                                                                              </ActivityAction.Argument>
                                                                              <Sequence DisplayName="正文" sap:VirtualizedContainerService.HintSize="716,1298" sap2010:WorkflowViewState.IdRef="Sequence_54">
                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                  </scg:Dictionary>
                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                <If sap2010:Annotation.AnnotationText="子表二次拆分码" Condition="[(iCount2+1)&lt;10]" DisplayName="编号判断" sap:VirtualizedContainerService.HintSize="674,245" sap2010:WorkflowViewState.IdRef="If_28">
                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                                    </scg:Dictionary>
                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                  <If.Then>
                                                                                    <Assign DisplayName="1-9" sap:VirtualizedContainerService.HintSize="263,61" sap2010:WorkflowViewState.IdRef="Assign_29">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[strSerialNumber2]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:String">["0"+(iCount2+1).ToString]</InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                  </If.Then>
                                                                                  <If.Else>
                                                                                    <Assign DisplayName="大于9" sap:VirtualizedContainerService.HintSize="263,61" sap2010:WorkflowViewState.IdRef="Assign_30">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[strSerialNumber2]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[(iCount2+1).ToString]</InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                  </If.Else>
                                                                                </If>
                                                                                <Flowchart sap2010:Annotation.AnnotationText="&#xA;&#xA;" DisplayName="流程图" sap:VirtualizedContainerService.HintSize="674,921" sap2010:WorkflowViewState.IdRef="Flowchart_3">
                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                      <av:Point x:Key="ShapeLocation">300,0</av:Point>
                                                                                      <av:Size x:Key="ShapeSize">60,75</av:Size>
                                                                                      <av:PointCollection x:Key="ConnectorLocation">330,75 330,105 312.5,105 312.5,126.5</av:PointCollection>
                                                                                      <x:Double x:Key="Width">640</x:Double>
                                                                                      <x:Double x:Key="Height">822.5</x:Double>
                                                                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                                    </scg:Dictionary>
                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                  <Flowchart.StartNode>
                                                                                    <x:Reference>__ReferenceID24</x:Reference>
                                                                                  </Flowchart.StartNode>
                                                                                  <FlowDecision x:Name="__ReferenceID24" sap2010:Annotation.AnnotationText="未解款金额是否超过了该客户的总打款金额" Condition="[dblPayment &gt; 0]" DisplayName="总额度" sap:VirtualizedContainerService.HintSize="70,87" sap2010:WorkflowViewState.IdRef="FlowDecision_6">
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                        <av:Point x:Key="ShapeLocation">295,126.5</av:Point>
                                                                                        <av:Size x:Key="ShapeSize">70,87</av:Size>
                                                                                        <av:PointCollection x:Key="TrueConnector">295,170 212,170 212,217.5</av:PointCollection>
                                                                                        <x:Boolean x:Key="IsAnnotationDocked">False</x:Boolean>
                                                                                        <av:PointCollection x:Key="FalseConnector">365,170 395,170 395,171 415,171</av:PointCollection>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                    <FlowDecision.True>
                                                                                      <FlowDecision x:Name="__ReferenceID15" sap2010:Annotation.AnnotationText="判断未解款金额是否小于一次拆分金额" Condition="[CDBL(row2(&quot;未解款金额&quot;).ToString) &lt;= dblPayment]" DisplayName="打款金额" sap:VirtualizedContainerService.HintSize="70,87" sap2010:WorkflowViewState.IdRef="FlowDecision_5">
                                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                            <av:Point x:Key="ShapeLocation">177,217.5</av:Point>
                                                                                            <av:Size x:Key="ShapeSize">70,87</av:Size>
                                                                                            <x:Boolean x:Key="IsAnnotationDocked">False</x:Boolean>
                                                                                            <av:PointCollection x:Key="TrueConnector">177,261 100,261 100,360.5</av:PointCollection>
                                                                                            <av:PointCollection x:Key="FalseConnector">247,261 340,261 340,360.5</av:PointCollection>
                                                                                          </scg:Dictionary>
                                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                                        <FlowDecision.True>
                                                                                          <FlowStep x:Name="__ReferenceID16">
                                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                <av:Point x:Key="ShapeLocation">0,360.5</av:Point>
                                                                                                <av:Size x:Key="ShapeSize">200,133</av:Size>
                                                                                                <av:PointCollection x:Key="ConnectorLocation">100,493.5 100,526</av:PointCollection>
                                                                                              </scg:Dictionary>
                                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                                            <ui:MultipleAssign sap2010:Annotation.AnnotationText="编号 二次拆分码 款项性质（收款单） 收款金额 销售订单号 主机编码&#xA;" DisplayName="货款类型，款项性质，二次拆分金额" sap:VirtualizedContainerService.HintSize="200,133" sap2010:WorkflowViewState.IdRef="MultipleAssign_28">
                                                                                              <ui:MultipleAssign.AssignOperations>
                                                                                                <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                                                                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_130">
                                                                                                    <ui:AssignOperation.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[arrSubTable(0)]</OutArgument>
                                                                                                    </ui:AssignOperation.To>
                                                                                                    <ui:AssignOperation.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">[row("编号").ToString]</InArgument>
                                                                                                    </ui:AssignOperation.Value>
                                                                                                  </ui:AssignOperation>
                                                                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_131">
                                                                                                    <ui:AssignOperation.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[arrSubTable(1)]</OutArgument>
                                                                                                    </ui:AssignOperation.To>
                                                                                                    <ui:AssignOperation.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">[strSerialNumber2]</InArgument>
                                                                                                    </ui:AssignOperation.Value>
                                                                                                  </ui:AssignOperation>
                                                                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_132">
                                                                                                    <ui:AssignOperation.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[arrSubTable(2)]</OutArgument>
                                                                                                    </ui:AssignOperation.To>
                                                                                                    <ui:AssignOperation.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">["0103"]</InArgument>
                                                                                                    </ui:AssignOperation.Value>
                                                                                                  </ui:AssignOperation>
                                                                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_133">
                                                                                                    <ui:AssignOperation.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[arrSubTable(3)]</OutArgument>
                                                                                                    </ui:AssignOperation.To>
                                                                                                    <ui:AssignOperation.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">[row2("未解款金额").ToString]</InArgument>
                                                                                                    </ui:AssignOperation.Value>
                                                                                                  </ui:AssignOperation>
                                                                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_134">
                                                                                                    <ui:AssignOperation.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[arrSubTable(12)]</OutArgument>
                                                                                                    </ui:AssignOperation.To>
                                                                                                    <ui:AssignOperation.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">[row2("设备编号").ToString]</InArgument>
                                                                                                    </ui:AssignOperation.Value>
                                                                                                  </ui:AssignOperation>
                                                                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_135">
                                                                                                    <ui:AssignOperation.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[arrSubTable(4)]</OutArgument>
                                                                                                    </ui:AssignOperation.To>
                                                                                                    <ui:AssignOperation.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">[dicReceivable(row2("设备编号").ToString)(1)]</InArgument>
                                                                                                    </ui:AssignOperation.Value>
                                                                                                  </ui:AssignOperation>
                                                                                                </scg:List>
                                                                                              </ui:MultipleAssign.AssignOperations>
                                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                                                </scg:Dictionary>
                                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                                            </ui:MultipleAssign>
                                                                                            <FlowStep.Next>
                                                                                              <FlowStep x:Name="__ReferenceID17">
                                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                    <av:Point x:Key="ShapeLocation">0,526</av:Point>
                                                                                                    <av:Size x:Key="ShapeSize">200,53</av:Size>
                                                                                                    <av:PointCollection x:Key="ConnectorLocation">100,579 100,620.5</av:PointCollection>
                                                                                                  </scg:Dictionary>
                                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                                <ui:AddDataRow DataRow="{x:Null}" sap2010:Annotation.AnnotationText="将此行待处理流水添加到子表" ArrayRow="[arrSubTable]" DataTable="[dtSubTable]" DisplayName="添加数据行" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="AddDataRow_17">
                                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                                                    </scg:Dictionary>
                                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                                </ui:AddDataRow>
                                                                                                <FlowStep.Next>
                                                                                                  <FlowStep x:Name="__ReferenceID18">
                                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                        <av:Point x:Key="ShapeLocation">0,620.5</av:Point>
                                                                                                        <av:Size x:Key="ShapeSize">200,99</av:Size>
                                                                                                      </scg:Dictionary>
                                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                                    <ui:MultipleAssign sap2010:Annotation.AnnotationText="折算打款金额与该客户的总打款金额" DisplayName="一次拆分金额" sap:VirtualizedContainerService.HintSize="200,99" sap2010:WorkflowViewState.IdRef="MultipleAssign_29">
                                                                                                      <ui:MultipleAssign.AssignOperations>
                                                                                                        <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_136">
                                                                                                            <ui:AssignOperation.To>
                                                                                                              <OutArgument x:TypeArguments="sd:DataRow[]">[arrOverdue]</OutArgument>
                                                                                                            </ui:AssignOperation.To>
                                                                                                            <ui:AssignOperation.Value>
                                                                                                              <InArgument x:TypeArguments="sd:DataRow[]">[dtRepaymentSchedule.Select("序号='"+row2("序号").ToString+"'")]</InArgument>
                                                                                                            </ui:AssignOperation.Value>
                                                                                                          </ui:AssignOperation>
                                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_137">
                                                                                                            <ui:AssignOperation.To>
                                                                                                              <OutArgument x:TypeArguments="x:Object">[arrOverdue(0)("客户名称")]</OutArgument>
                                                                                                            </ui:AssignOperation.To>
                                                                                                            <ui:AssignOperation.Value>
                                                                                                              <InArgument x:TypeArguments="x:Object">[arrOverdue(0)("客户名称").ToString+“-”]</InArgument>
                                                                                                            </ui:AssignOperation.Value>
                                                                                                          </ui:AssignOperation>
                                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_138">
                                                                                                            <ui:AssignOperation.To>
                                                                                                              <OutArgument x:TypeArguments="x:Double">[dblPayment]</OutArgument>
                                                                                                            </ui:AssignOperation.To>
                                                                                                            <ui:AssignOperation.Value>
                                                                                                              <InArgument x:TypeArguments="x:Double">[dblPayment-CDbl(row2("未解款金额").ToString)]</InArgument>
                                                                                                            </ui:AssignOperation.Value>
                                                                                                          </ui:AssignOperation>
                                                                                                        </scg:List>
                                                                                                      </ui:MultipleAssign.AssignOperations>
                                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                                                        </scg:Dictionary>
                                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                                    </ui:MultipleAssign>
                                                                                                  </FlowStep>
                                                                                                </FlowStep.Next>
                                                                                              </FlowStep>
                                                                                            </FlowStep.Next>
                                                                                          </FlowStep>
                                                                                        </FlowDecision.True>
                                                                                        <FlowDecision.False>
                                                                                          <FlowStep x:Name="__ReferenceID20">
                                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                <av:Point x:Key="ShapeLocation">240,360.5</av:Point>
                                                                                                <av:Size x:Key="ShapeSize">200,116</av:Size>
                                                                                                <av:PointCollection x:Key="ConnectorLocation">340,476.5 340,519.5</av:PointCollection>
                                                                                              </scg:Dictionary>
                                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                                            <ui:MultipleAssign sap2010:Annotation.AnnotationText="编号 二次拆分码 款项性质（收款单） 收款金额 销售订单号 主机编码" DisplayName="货款类型，款项性质，二次拆分金额" sap:VirtualizedContainerService.HintSize="200,116" sap2010:WorkflowViewState.IdRef="MultipleAssign_30">
                                                                                              <ui:MultipleAssign.AssignOperations>
                                                                                                <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                                                                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_139">
                                                                                                    <ui:AssignOperation.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[arrSubTable(0)]</OutArgument>
                                                                                                    </ui:AssignOperation.To>
                                                                                                    <ui:AssignOperation.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">[row("编号").ToString]</InArgument>
                                                                                                    </ui:AssignOperation.Value>
                                                                                                  </ui:AssignOperation>
                                                                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_140">
                                                                                                    <ui:AssignOperation.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[arrSubTable(1)]</OutArgument>
                                                                                                    </ui:AssignOperation.To>
                                                                                                    <ui:AssignOperation.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">[strSerialNumber2]</InArgument>
                                                                                                    </ui:AssignOperation.Value>
                                                                                                  </ui:AssignOperation>
                                                                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_141">
                                                                                                    <ui:AssignOperation.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[arrSubTable(2)]</OutArgument>
                                                                                                    </ui:AssignOperation.To>
                                                                                                    <ui:AssignOperation.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">["0103"]</InArgument>
                                                                                                    </ui:AssignOperation.Value>
                                                                                                  </ui:AssignOperation>
                                                                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_142">
                                                                                                    <ui:AssignOperation.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[arrSubTable(3)]</OutArgument>
                                                                                                    </ui:AssignOperation.To>
                                                                                                    <ui:AssignOperation.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">[dblPayment.ToString]</InArgument>
                                                                                                    </ui:AssignOperation.Value>
                                                                                                  </ui:AssignOperation>
                                                                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_143">
                                                                                                    <ui:AssignOperation.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[arrSubTable(12)]</OutArgument>
                                                                                                    </ui:AssignOperation.To>
                                                                                                    <ui:AssignOperation.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">[row2("设备编号").ToString]</InArgument>
                                                                                                    </ui:AssignOperation.Value>
                                                                                                  </ui:AssignOperation>
                                                                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_144">
                                                                                                    <ui:AssignOperation.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[arrSubTable(4)]</OutArgument>
                                                                                                    </ui:AssignOperation.To>
                                                                                                    <ui:AssignOperation.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">[dicReceivable(row2("设备编号").ToString)(1)]</InArgument>
                                                                                                    </ui:AssignOperation.Value>
                                                                                                  </ui:AssignOperation>
                                                                                                </scg:List>
                                                                                              </ui:MultipleAssign.AssignOperations>
                                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                                                </scg:Dictionary>
                                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                                            </ui:MultipleAssign>
                                                                                            <FlowStep.Next>
                                                                                              <FlowStep x:Name="__ReferenceID21">
                                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                    <av:Point x:Key="ShapeLocation">240,519.5</av:Point>
                                                                                                    <av:Size x:Key="ShapeSize">200,53</av:Size>
                                                                                                    <av:PointCollection x:Key="ConnectorLocation">340,572.5 340,620.5</av:PointCollection>
                                                                                                  </scg:Dictionary>
                                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                                <ui:AddDataRow DataRow="{x:Null}" sap2010:Annotation.AnnotationText="将此行待处理流水添加到子表" ArrayRow="[arrSubTable]" DataTable="[dtSubTable]" DisplayName="添加数据行" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="AddDataRow_18">
                                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                                                    </scg:Dictionary>
                                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                                </ui:AddDataRow>
                                                                                                <FlowStep.Next>
                                                                                                  <FlowStep x:Name="__ReferenceID19">
                                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                        <av:Point x:Key="ShapeLocation">240,620.5</av:Point>
                                                                                                        <av:Size x:Key="ShapeSize">200,99</av:Size>
                                                                                                        <av:PointCollection x:Key="ConnectorLocation">340,719.5 340,769.5</av:PointCollection>
                                                                                                      </scg:Dictionary>
                                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                                    <ui:MultipleAssign sap2010:Annotation.AnnotationText="折算打款金额与该客户的总打款金额" DisplayName="一次拆分金额" sap:VirtualizedContainerService.HintSize="200,99" sap2010:WorkflowViewState.IdRef="MultipleAssign_31">
                                                                                                      <ui:MultipleAssign.AssignOperations>
                                                                                                        <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_145">
                                                                                                            <ui:AssignOperation.To>
                                                                                                              <OutArgument x:TypeArguments="sd:DataRow[]">[arrOverdue]</OutArgument>
                                                                                                            </ui:AssignOperation.To>
                                                                                                            <ui:AssignOperation.Value>
                                                                                                              <InArgument x:TypeArguments="sd:DataRow[]">[dtRepaymentSchedule.Select("序号='"+row2("序号").ToString+"'")]</InArgument>
                                                                                                            </ui:AssignOperation.Value>
                                                                                                          </ui:AssignOperation>
                                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_146">
                                                                                                            <ui:AssignOperation.To>
                                                                                                              <OutArgument x:TypeArguments="x:Object">[arrOverdue(0)("未解款金额")]</OutArgument>
                                                                                                            </ui:AssignOperation.To>
                                                                                                            <ui:AssignOperation.Value>
                                                                                                              <InArgument x:TypeArguments="x:Object">[(Cdbl(arrOverdue(0)("未解款金额").ToString)-dblPayment).ToString]</InArgument>
                                                                                                            </ui:AssignOperation.Value>
                                                                                                          </ui:AssignOperation>
                                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_147">
                                                                                                            <ui:AssignOperation.To>
                                                                                                              <OutArgument x:TypeArguments="x:Double">[dblPayment]</OutArgument>
                                                                                                            </ui:AssignOperation.To>
                                                                                                            <ui:AssignOperation.Value>
                                                                                                              <InArgument x:TypeArguments="x:Double">0</InArgument>
                                                                                                            </ui:AssignOperation.Value>
                                                                                                          </ui:AssignOperation>
                                                                                                        </scg:List>
                                                                                                      </ui:MultipleAssign.AssignOperations>
                                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                                                        </scg:Dictionary>
                                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                                    </ui:MultipleAssign>
                                                                                                    <FlowStep.Next>
                                                                                                      <FlowStep x:Name="__ReferenceID23">
                                                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                            <av:Point x:Key="ShapeLocation">240,769.5</av:Point>
                                                                                                            <av:Size x:Key="ShapeSize">200,22</av:Size>
                                                                                                          </scg:Dictionary>
                                                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                                                        <ui:Break DisplayName="中断" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Break_3">
                                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                            </scg:Dictionary>
                                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                                        </ui:Break>
                                                                                                      </FlowStep>
                                                                                                    </FlowStep.Next>
                                                                                                  </FlowStep>
                                                                                                </FlowStep.Next>
                                                                                              </FlowStep>
                                                                                            </FlowStep.Next>
                                                                                          </FlowStep>
                                                                                        </FlowDecision.False>
                                                                                      </FlowDecision>
                                                                                    </FlowDecision.True>
                                                                                    <FlowDecision.False>
                                                                                      <FlowStep x:Name="__ReferenceID22">
                                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                            <av:Point x:Key="ShapeLocation">415,160</av:Point>
                                                                                            <av:Size x:Key="ShapeSize">200,22</av:Size>
                                                                                          </scg:Dictionary>
                                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                                        <ui:Break DisplayName="中断" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Break_4">
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                        </ui:Break>
                                                                                      </FlowStep>
                                                                                    </FlowDecision.False>
                                                                                  </FlowDecision>
                                                                                  <x:Reference>__ReferenceID15</x:Reference>
                                                                                  <x:Reference>__ReferenceID16</x:Reference>
                                                                                  <x:Reference>__ReferenceID17</x:Reference>
                                                                                  <x:Reference>__ReferenceID18</x:Reference>
                                                                                  <x:Reference>__ReferenceID19</x:Reference>
                                                                                  <x:Reference>__ReferenceID20</x:Reference>
                                                                                  <x:Reference>__ReferenceID21</x:Reference>
                                                                                  <x:Reference>__ReferenceID22</x:Reference>
                                                                                  <x:Reference>__ReferenceID23</x:Reference>
                                                                                </Flowchart>
                                                                              </Sequence>
                                                                            </ActivityAction>
                                                                          </ui:ForEachRow.Body>
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                        </ui:ForEachRow>
                                                                        <ui:ClearDataTable DataTable="[dtOverduePending]" DisplayName="清除数据表" sap:VirtualizedContainerService.HintSize="766,22" sap2010:WorkflowViewState.IdRef="ClearDataTable_3" />
                                                                      </Sequence>
                                                                    </If.Then>
                                                                  </If>
                                                                </Sequence>
                                                              </Sequence>
                                                            </Sequence>
                                                          </ActivityAction>
                                                        </ui:ForEachRow.Body>
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                      </ui:ForEachRow>
                                                      <FlowStep.Next>
                                                        <FlowStep x:Name="__ReferenceID35">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <av:Point x:Key="ShapeLocation">380,1748</av:Point>
                                                              <av:Size x:Key="ShapeSize">200,84</av:Size>
                                                              <av:PointCollection x:Key="ConnectorLocation">480,1832 480,1879</av:PointCollection>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <If sap2010:Annotation.AnnotationText="异常表写入" Condition="[dtErrorRow.Rows.Count &gt;0]" DisplayName="异常表写入" sap:VirtualizedContainerService.HintSize="200,84" sap2010:WorkflowViewState.IdRef="If_31">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <If.Then>
                                                              <Sequence DisplayName="序列" sap:VirtualizedContainerService.HintSize="476,730" sap2010:WorkflowViewState.IdRef="Sequence_62">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <ui:ExcelApplicationScope Password="{x:Null}" DisplayName="人工维护表" sap:VirtualizedContainerService.HintSize="434,638" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_12" InstanceCachePeriod="3000" WorkbookPath="[in_Config(&quot;PZB&quot;).ToString+in_Config(&quot;RGWHB&quot;).ToString]">
                                                                  <ui:ExcelApplicationScope.Body>
                                                                    <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                                                                      <ActivityAction.Argument>
                                                                        <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                                                                      </ActivityAction.Argument>
                                                                      <Sequence DisplayName="执行" sap:VirtualizedContainerService.HintSize="376,529" sap2010:WorkflowViewState.IdRef="Sequence_66">
                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                          </scg:Dictionary>
                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                        <ui:ExcelAppendRange DataTable="[dtErrorRow]" DisplayName="附加范围" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelAppendRange_2" SheetName="按揭放款异常表" />
                                                                        <ui:ExcelReadRange AddHeaders="True" DataTable="[dtErrorTable]" DisplayName="读取范围" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="ExcelReadRange_13" SheetName="按揭放款异常表">
                                                                          <ui:ExcelReadRange.Range>
                                                                            <InArgument x:TypeArguments="x:String">
                                                                              <Literal x:TypeArguments="x:String" Value="" />
                                                                            </InArgument>
                                                                          </ui:ExcelReadRange.Range>
                                                                        </ui:ExcelReadRange>
                                                                        <ui:RemoveDuplicateRows DataTable="[dtErrorRow]" DisplayName="删除重复行" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="RemoveDuplicateRows_3" OutputDataTable="[dtErrorRow]" />
                                                                        <ui:ExcelDeleteRange DisplayName="删除范围" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="ExcelDeleteRange_3" Range="A1:IT65535" SheetName="按揭放款异常表" ShiftCells="False" ShiftOption="ShiftUp" />
                                                                        <ui:ExcelWriteRange AddHeaders="True" DataTable="[dtErrorRow]" DisplayName="写入范围" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteRange_7" SheetName="按揭放款异常表" StartingCell="A1" />
                                                                      </Sequence>
                                                                    </ActivityAction>
                                                                  </ui:ExcelApplicationScope.Body>
                                                                </ui:ExcelApplicationScope>
                                                              </Sequence>
                                                            </If.Then>
                                                          </If>
                                                          <FlowStep.Next>
                                                            <FlowStep x:Name="__ReferenceID36">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <av:Point x:Key="ShapeLocation">380,1879</av:Point>
                                                                  <av:Size x:Key="ShapeSize">200,22</av:Size>
                                                                  <av:PointCollection x:Key="ConnectorLocation">480,1901 480,1953.5</av:PointCollection>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <ui:ClearDataTable DataTable="[dtErrorRow]" DisplayName="清除数据表" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="ClearDataTable_5">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                              </ui:ClearDataTable>
                                                              <FlowStep.Next>
                                                                <FlowStep x:Name="__ReferenceID37">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <av:Point x:Key="ShapeLocation">380,1953.5</av:Point>
                                                                      <av:Size x:Key="ShapeSize">200,53</av:Size>
                                                                      <av:PointCollection x:Key="ConnectorLocation">480,2006.5 480,2052.5</av:PointCollection>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <ui:CopyFile ContinueOnError="{x:Null}" Destination="[in_Config(&quot;JGB&quot;).ToString+in_Config(&quot;AJFKJGB&quot;).ToString]" DisplayName="复制底稿模板" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="CopyFile_2" Overwrite="True" Path="[in_Config(&quot;PZB&quot;).ToString+in_Config(&quot;AJFKDRMB&quot;).ToString]">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                  </ui:CopyFile>
                                                                  <FlowStep.Next>
                                                                    <FlowStep x:Name="__ReferenceID38">
                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                          <av:Point x:Key="ShapeLocation">380,2052.5</av:Point>
                                                                          <av:Size x:Key="ShapeSize">200,235</av:Size>
                                                                          <av:PointCollection x:Key="ConnectorLocation">480,2287.5 480,2333</av:PointCollection>
                                                                        </scg:Dictionary>
                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                      <ui:ExcelApplicationScope Password="{x:Null}" sap2010:Annotation.AnnotationText="in_Config(&quot;DCLJG&quot;).ToString+in_Config(&quot;Year&quot;).ToString+&quot;\&quot;+in_Config(&quot;Month&quot;).ToString+&quot;\&quot;+in_Config(&quot;Day&quot;).ToString+&quot;\&quot;+in_Config(&quot;Minute&quot;).ToString+&quot;\按揭放款收款单.xls&quot;" DisplayName="底稿模板值写入" sap:VirtualizedContainerService.HintSize="200,235" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_9" InstanceCachePeriod="3000" WorkbookPath="[in_Config(&quot;JGB&quot;).ToString+in_Config(&quot;AJFKJGB&quot;).ToString]">
                                                                        <ui:ExcelApplicationScope.Body>
                                                                          <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                                                                            <ActivityAction.Argument>
                                                                              <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                                                                            </ActivityAction.Argument>
                                                                            <Sequence DisplayName="执行" sap:VirtualizedContainerService.HintSize="376,482" sap2010:WorkflowViewState.IdRef="Sequence_34">
                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                </scg:Dictionary>
                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                              <ui:ExcelWriteRange AddHeaders="True" DataTable="[dtMainTable]" DisplayName="主表" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteRange_4" SheetName="主表" StartingCell="A2" />
                                                                              <ui:ExcelWriteRange AddHeaders="True" DataTable="[dtSubTable]" DisplayName="子表" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteRange_3" SheetName="子表" StartingCell="A2" />
                                                                              <ui:AppendLine DisplayName="本地日志" FileName="[&quot;Log\&quot;+Now.Year.ToString+&quot;\&quot;+Now.Month.ToString+&quot;\&quot;+Now.Day.ToString+&quot;号主机解款运行日志.txt&quot;]" sap:VirtualizedContainerService.HintSize="334,136" sap2010:WorkflowViewState.IdRef="AppendLine_1" Text="[now.ToString(&quot;yyyy-MM-dd hh:mm:ss&quot;)+&quot;：------按揭放款还款计划匹配完毕&quot;]" UseDefaultEncoding="False" />
                                                                            </Sequence>
                                                                          </ActivityAction>
                                                                        </ui:ExcelApplicationScope.Body>
                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                          </scg:Dictionary>
                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                      </ui:ExcelApplicationScope>
                                                                      <FlowStep.Next>
                                                                        <FlowStep x:Name="__ReferenceID39">
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <av:Point x:Key="ShapeLocation">380,2333</av:Point>
                                                                              <av:Size x:Key="ShapeSize">200,354</av:Size>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                          <Sequence sap2010:Annotation.AnnotationText="1.读取放款汇总模板&#xA;2.遍历放款明细，写入字典，key：合同主体/合同买受人，value：{row(&quot;放贷金融机构&quot;).ToString,row(&quot;银行按揭合同号/融资租赁合同号&quot;).ToString,row(&quot;贷款额（万元）&quot;).ToString}&#xA;3.遍历子表，key：编号；value:客户档案&#xA;4.遍历子表，开始提取汇总数据。根据编号从主表提取到客户档案，再根据客户档案从放款明细提取其他字段并从流水配置页根据客户档案提取客户编码" DisplayName="序列" sap:VirtualizedContainerService.HintSize="563,2467" sap2010:WorkflowViewState.IdRef="Sequence_76">
                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                              </scg:Dictionary>
                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                            <ui:ExcelApplicationScope Password="{x:Null}" DisplayName="Excel 应用程序范围" sap:VirtualizedContainerService.HintSize="521,260" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_15" InstanceCachePeriod="3000" WorkbookPath="[in_Config(&quot;PZB&quot;).ToString+in_Config(&quot;AJFKHZMB&quot;).ToString]">
                                                                              <ui:ExcelApplicationScope.Body>
                                                                                <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                                                                                  <ActivityAction.Argument>
                                                                                    <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                                                                                  </ActivityAction.Argument>
                                                                                  <Sequence DisplayName="执行" sap:VirtualizedContainerService.HintSize="376,151" sap2010:WorkflowViewState.IdRef="Sequence_83">
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                    <ui:ExcelReadRange AddHeaders="True" DataTable="[dtCollects]" DisplayName="读取范围" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="ExcelReadRange_17" SheetName="汇总">
                                                                                      <ui:ExcelReadRange.Range>
                                                                                        <InArgument x:TypeArguments="x:String">
                                                                                          <Literal x:TypeArguments="x:String" Value="" />
                                                                                        </InArgument>
                                                                                      </ui:ExcelReadRange.Range>
                                                                                    </ui:ExcelReadRange>
                                                                                  </Sequence>
                                                                                </ActivityAction>
                                                                              </ui:ExcelApplicationScope.Body>
                                                                            </ui:ExcelApplicationScope>
                                                                            <ui:ForEachRow CurrentIndex="{x:Null}" DataTable="[dtLoanDetails]" DisplayName="放款明细数据整理" sap:VirtualizedContainerService.HintSize="521,304" sap2010:WorkflowViewState.IdRef="ForEachRow_24">
                                                                              <ui:ForEachRow.Body>
                                                                                <ActivityAction x:TypeArguments="sd:DataRow">
                                                                                  <ActivityAction.Argument>
                                                                                    <DelegateInArgument x:TypeArguments="sd:DataRow" Name="row" />
                                                                                  </ActivityAction.Argument>
                                                                                  <Sequence DisplayName="正文" sap:VirtualizedContainerService.HintSize="305,153" sap2010:WorkflowViewState.IdRef="Sequence_80">
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                    <Assign DisplayName="放款字典写入" sap:VirtualizedContainerService.HintSize="263,61" sap2010:WorkflowViewState.IdRef="Assign_43">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="s:String[]">[dicCollectsOfLoanDetails(row("合同主体/合同买受人/").ToString)]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="s:String[]">[{row("放贷金融机构").ToString,row("银行按揭合同号/融资租赁合同号").ToString,row("贷款额（万元）").ToString}]</InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                  </Sequence>
                                                                                </ActivityAction>
                                                                              </ui:ForEachRow.Body>
                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                </scg:Dictionary>
                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                            </ui:ForEachRow>
                                                                            <ui:ForEachRow CurrentIndex="{x:Null}" DataTable="[dtMainTable]" DisplayName="主表数据整理" sap:VirtualizedContainerService.HintSize="521,304" sap2010:WorkflowViewState.IdRef="ForEachRow_25">
                                                                              <ui:ForEachRow.Body>
                                                                                <ActivityAction x:TypeArguments="sd:DataRow">
                                                                                  <ActivityAction.Argument>
                                                                                    <DelegateInArgument x:TypeArguments="sd:DataRow" Name="row" />
                                                                                  </ActivityAction.Argument>
                                                                                  <Sequence DisplayName="正文" sap:VirtualizedContainerService.HintSize="305,153" sap2010:WorkflowViewState.IdRef="Sequence_81">
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                    <Assign DisplayName="主表字典写入" sap:VirtualizedContainerService.HintSize="263,61" sap2010:WorkflowViewState.IdRef="Assign_44">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[dicCollectsOfMainTable(row("编号").ToString)]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[row("客户档案").ToString]</InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                  </Sequence>
                                                                                </ActivityAction>
                                                                              </ui:ForEachRow.Body>
                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                </scg:Dictionary>
                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                            </ui:ForEachRow>
                                                                            <ui:ForEachRow CurrentIndex="{x:Null}" sap2010:Annotation.AnnotationText="   &#xA;" DataTable="[dtSubTable]" DisplayName="月度汇总数据整理" sap:VirtualizedContainerService.HintSize="521,99" sap2010:WorkflowViewState.IdRef="ForEachRow_26">
                                                                              <ui:ForEachRow.Body>
                                                                                <ActivityAction x:TypeArguments="sd:DataRow">
                                                                                  <ActivityAction.Argument>
                                                                                    <DelegateInArgument x:TypeArguments="sd:DataRow" Name="row" />
                                                                                  </ActivityAction.Argument>
                                                                                  <Sequence DisplayName="正文" sap:VirtualizedContainerService.HintSize="526,1021" sap2010:WorkflowViewState.IdRef="Sequence_82">
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                    <If Condition="[row(&quot;编号&quot;).ToString.Trim.Equals(&quot;文本&quot;)]" DisplayName="IF 条件" sap:VirtualizedContainerService.HintSize="484,213" sap2010:WorkflowViewState.IdRef="If_46">
                                                                                      <If.Then>
                                                                                        <ui:Continue DisplayName="继续" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Continue_3" />
                                                                                      </If.Then>
                                                                                    </If>
                                                                                    <TryCatch DisplayName="Try Catch 异常处理" sap:VirtualizedContainerService.HintSize="484,614" sap2010:WorkflowViewState.IdRef="TryCatch_1">
                                                                                      <TryCatch.Try>
                                                                                        <ui:MultipleAssign DisplayName="多重分配" sap:VirtualizedContainerService.HintSize="334,377" sap2010:WorkflowViewState.IdRef="MultipleAssign_41">
                                                                                          <ui:MultipleAssign.AssignOperations>
                                                                                            <scg:List x:TypeArguments="ui:AssignOperation" Capacity="16">
                                                                                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_190">
                                                                                                <ui:AssignOperation.To>
                                                                                                  <OutArgument x:TypeArguments="s:String[]">[arrCollects]</OutArgument>
                                                                                                </ui:AssignOperation.To>
                                                                                                <ui:AssignOperation.Value>
                                                                                                  <InArgument x:TypeArguments="s:String[]">[{"","","","","","","","",""}]</InArgument>
                                                                                                </ui:AssignOperation.Value>
                                                                                              </ui:AssignOperation>
                                                                                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_191">
                                                                                                <ui:AssignOperation.To>
                                                                                                  <OutArgument x:TypeArguments="x:String">[arrCollects(0)]</OutArgument>
                                                                                                </ui:AssignOperation.To>
                                                                                                <ui:AssignOperation.Value>
                                                                                                  <InArgument x:TypeArguments="x:String">[dicCollectsOfMainTable(row("编号").ToString)]</InArgument>
                                                                                                </ui:AssignOperation.Value>
                                                                                              </ui:AssignOperation>
                                                                                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_192">
                                                                                                <ui:AssignOperation.To>
                                                                                                  <OutArgument x:TypeArguments="x:String">[arrCollects(1)]</OutArgument>
                                                                                                </ui:AssignOperation.To>
                                                                                                <ui:AssignOperation.Value>
                                                                                                  <InArgument x:TypeArguments="x:String">[dicPendingTask(dicCollectsOfMainTable(row("编号").ToString))(0)]</InArgument>
                                                                                                </ui:AssignOperation.Value>
                                                                                              </ui:AssignOperation>
                                                                                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_193">
                                                                                                <ui:AssignOperation.To>
                                                                                                  <OutArgument x:TypeArguments="x:String">[arrCollects(2)]</OutArgument>
                                                                                                </ui:AssignOperation.To>
                                                                                                <ui:AssignOperation.Value>
                                                                                                  <InArgument x:TypeArguments="x:String">[dicCollectsOfLoanDetails(dicPendingTask(dicCollectsOfMainTable(row("编号").ToString))(0))(0)]</InArgument>
                                                                                                </ui:AssignOperation.Value>
                                                                                              </ui:AssignOperation>
                                                                                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_194">
                                                                                                <ui:AssignOperation.To>
                                                                                                  <OutArgument x:TypeArguments="x:String">[arrCollects(3)]</OutArgument>
                                                                                                </ui:AssignOperation.To>
                                                                                                <ui:AssignOperation.Value>
                                                                                                  <InArgument x:TypeArguments="x:String">[dicCollectsOfLoanDetails(dicPendingTask(dicCollectsOfMainTable(row("编号").ToString))(0))(1)]</InArgument>
                                                                                                </ui:AssignOperation.Value>
                                                                                              </ui:AssignOperation>
                                                                                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_195">
                                                                                                <ui:AssignOperation.To>
                                                                                                  <OutArgument x:TypeArguments="x:String">[arrCollects(4)]</OutArgument>
                                                                                                </ui:AssignOperation.To>
                                                                                                <ui:AssignOperation.Value>
                                                                                                  <InArgument x:TypeArguments="x:String">[dicCollectsOfLoanDetails(dicPendingTask(dicCollectsOfMainTable(row("编号").ToString))(0))(2)]</InArgument>
                                                                                                </ui:AssignOperation.Value>
                                                                                              </ui:AssignOperation>
                                                                                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_196">
                                                                                                <ui:AssignOperation.To>
                                                                                                  <OutArgument x:TypeArguments="x:String">[arrCollects(5)]</OutArgument>
                                                                                                </ui:AssignOperation.To>
                                                                                                <ui:AssignOperation.Value>
                                                                                                  <InArgument x:TypeArguments="x:String">[row("销售订单号").ToString]</InArgument>
                                                                                                </ui:AssignOperation.Value>
                                                                                              </ui:AssignOperation>
                                                                                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_197">
                                                                                                <ui:AssignOperation.To>
                                                                                                  <OutArgument x:TypeArguments="x:String">[arrCollects(6)]</OutArgument>
                                                                                                </ui:AssignOperation.To>
                                                                                                <ui:AssignOperation.Value>
                                                                                                  <InArgument x:TypeArguments="x:String">[row("主机编码").ToString]</InArgument>
                                                                                                </ui:AssignOperation.Value>
                                                                                              </ui:AssignOperation>
                                                                                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_198">
                                                                                                <ui:AssignOperation.To>
                                                                                                  <OutArgument x:TypeArguments="x:String">[arrCollects(7)]</OutArgument>
                                                                                                </ui:AssignOperation.To>
                                                                                                <ui:AssignOperation.Value>
                                                                                                  <InArgument x:TypeArguments="x:String">[row("收款金额").ToString]</InArgument>
                                                                                                </ui:AssignOperation.Value>
                                                                                              </ui:AssignOperation>
                                                                                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_199">
                                                                                                <ui:AssignOperation.To>
                                                                                                  <OutArgument x:TypeArguments="x:String">[arrCollects(8)]</OutArgument>
                                                                                                </ui:AssignOperation.To>
                                                                                                <ui:AssignOperation.Value>
                                                                                                  <InArgument x:TypeArguments="x:String">
                                                                                                    <Literal x:TypeArguments="x:String" Value="" />
                                                                                                  </InArgument>
                                                                                                </ui:AssignOperation.Value>
                                                                                              </ui:AssignOperation>
                                                                                            </scg:List>
                                                                                          </ui:MultipleAssign.AssignOperations>
                                                                                        </ui:MultipleAssign>
                                                                                      </TryCatch.Try>
                                                                                      <TryCatch.Catches>
                                                                                        <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,23" sap2010:WorkflowViewState.IdRef="Catch`1_1">
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                          <ActivityAction x:TypeArguments="s:Exception">
                                                                                            <ActivityAction.Argument>
                                                                                              <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                                                            </ActivityAction.Argument>
                                                                                            <Sequence DisplayName="序列" sap:VirtualizedContainerService.HintSize="376,187" sap2010:WorkflowViewState.IdRef="Sequence_85">
                                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                </scg:Dictionary>
                                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                                              <ui:LogMessage DisplayName="日志消息" sap:VirtualizedContainerService.HintSize="334,95" sap2010:WorkflowViewState.IdRef="LogMessage_2" Level="Trace" Message="[&quot;请核查&quot;+dicCollectsOfMainTable(row(&quot;编号&quot;).ToString)+&quot;是待处理流水配置页或放款明细是否有对应客户&quot;]" />
                                                                                            </Sequence>
                                                                                          </ActivityAction>
                                                                                        </Catch>
                                                                                      </TryCatch.Catches>
                                                                                    </TryCatch>
                                                                                    <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[arrCollects]" DataTable="[dtCollects]" DisplayName="添加数据行" sap:VirtualizedContainerService.HintSize="484,22" sap2010:WorkflowViewState.IdRef="AddDataRow_23" />
                                                                                  </Sequence>
                                                                                </ActivityAction>
                                                                              </ui:ForEachRow.Body>
                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                                </scg:Dictionary>
                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                            </ui:ForEachRow>
                                                                            <ui:CopyFile ContinueOnError="{x:Null}" Destination="[in_Config(&quot;JGB&quot;).ToString+in_Config(&quot;AJFKSJTQB&quot;).ToString]" DisplayName="复制文件" sap:VirtualizedContainerService.HintSize="521,53" sap2010:WorkflowViewState.IdRef="CopyFile_4" Overwrite="True" Path="[in_Config(&quot;PZB&quot;).ToString+in_Config(&quot;AJFKHZMB&quot;).ToString]">
                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                </scg:Dictionary>
                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                            </ui:CopyFile>
                                                                            <ui:ExcelApplicationScope Password="{x:Null}" DisplayName="厂端解款表参照" sap:VirtualizedContainerService.HintSize="521,288" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_16" InstanceCachePeriod="3000" WorkbookPath="[in_Config(&quot;JGB&quot;).ToString+in_Config(&quot;AJFKSJTQB&quot;).ToString]">
                                                                              <ui:ExcelApplicationScope.Body>
                                                                                <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                                                                                  <ActivityAction.Argument>
                                                                                    <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                                                                                  </ActivityAction.Argument>
                                                                                  <Sequence DisplayName="执行" sap:VirtualizedContainerService.HintSize="376,179" sap2010:WorkflowViewState.IdRef="Sequence_84">
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                    <ui:ExcelWriteRange AddHeaders="True" DataTable="[dtCollects]" DisplayName="写入范围" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteRange_9" SheetName="汇总" StartingCell="A1" />
                                                                                  </Sequence>
                                                                                </ActivityAction>
                                                                              </ui:ExcelApplicationScope.Body>
                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                </scg:Dictionary>
                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                            </ui:ExcelApplicationScope>
                                                                            <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="月度汇总" sap:VirtualizedContainerService.HintSize="521,114" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_6" UnSafe="False" WorkflowFileName="Framework\TtableBelow.xaml">
                                                                              <ui:InvokeWorkflowFile.Arguments>
                                                                                <InArgument x:TypeArguments="sd:DataTable" x:Key="in_SourceTable">[dtCollects]</InArgument>
                                                                                <InArgument x:TypeArguments="x:String" x:Key="in_FilePath">[in_Config("JGBZB").ToString+in_Config("Year").ToString+"\"+in_Config("Month").ToString+"\"+"按揭放款汇总.xls"]</InArgument>
                                                                                <InArgument x:TypeArguments="x:String" x:Key="in_SheetName">汇总</InArgument>
                                                                                <InArgument x:TypeArguments="x:String" x:Key="in_SourePath">[in_Config("PZB").ToString+in_Config("AJFKHZMB").ToString]</InArgument>
                                                                              </ui:InvokeWorkflowFile.Arguments>
                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                </scg:Dictionary>
                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                            </ui:InvokeWorkflowFile>
                                                                            <ui:AppendLine DisplayName="本地日志" FileName="[&quot;Log\&quot;+Now.Year.ToString+&quot;\&quot;+Now.Month.ToString+&quot;\&quot;+Now.Day.ToString+&quot;号主机解款运行日志.txt&quot;]" sap:VirtualizedContainerService.HintSize="521,136" sap2010:WorkflowViewState.IdRef="AppendLine_2" Text="[now.ToString(&quot;yyyy-MM-dd hh:mm:ss&quot;)+&quot;：------按揭放款数据汇总提取表写入完毕&quot;]" UseDefaultEncoding="False" />
                                                                            <If Condition="[in_Config(&quot;MessageBoxRemind&quot;).Equals(&quot;Y&quot;)]" DisplayName="是否需要弹窗" sap:VirtualizedContainerService.HintSize="521,366" sap2010:WorkflowViewState.IdRef="If_47">
                                                                              <If.Then>
                                                                                <Sequence DisplayName="序列" sap:VirtualizedContainerService.HintSize="376,213" sap2010:WorkflowViewState.IdRef="Sequence_86">
                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                    </scg:Dictionary>
                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                  <ui:MessageBox ChosenButton="{x:Null}" Caption="核对完毕前请勿点击确认" DisplayName="消息框" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="MessageBox_1" Text="[&quot;按揭放款底稿与汇总提取表已读写完毕，请仔细核对此表，最终放款导入与核销将以此表为准&quot;+vbCrLf+&quot;按揭放款底稿路径：&quot;+in_Config(&quot;JGB&quot;).ToString+in_Config(&quot;AJFKJGB&quot;).ToString+vbCrLf+&quot;如有遗留款请查看人工维护表的放款异常Sheet页中是否存在放款金额与SAP回款金额不一致或客户映射关系在待处理底稿模板中是否存在，人工维护表路径：&quot;+in_Config(&quot;PZB&quot;).ToString+in_Config(&quot;RGWHB&quot;).ToString+&quot;放款汇总表路径：&quot;+in_Config(&quot;JGB&quot;).ToString+in_Config(&quot;AJFKSJTQB&quot;).ToString+vbCrLf+&quot;----如需取消本弹窗可在'D:\BSDLS\4.最新源码\BSDLS_RPA0002_主机解款\Config\Config.xlsx'文件中将MessageBoxRemind对应的Value值改为N，其他提示弹窗也会一并取消（标记提示弹窗除外）,为Y则继续保留此弹窗----&quot;]" TopMost="True" />
                                                                                  <ui:KillProcess Process="{x:Null}" ContinueOnError="True" DisplayName="Kill Process &quot;Excel&quot;" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="KillProcess_1" ProcessName="Excel" />
                                                                                </Sequence>
                                                                              </If.Then>
                                                                            </If>
                                                                          </Sequence>
                                                                        </FlowStep>
                                                                      </FlowStep.Next>
                                                                    </FlowStep>
                                                                  </FlowStep.Next>
                                                                </FlowStep>
                                                              </FlowStep.Next>
                                                            </FlowStep>
                                                          </FlowStep.Next>
                                                        </FlowStep>
                                                      </FlowStep.Next>
                                                    </FlowStep>
                                                  </FlowStep.Next>
                                                </FlowStep>
                                              </FlowStep.Next>
                                            </FlowStep>
                                          </FlowStep.Next>
                                        </FlowStep>
                                      </FlowStep.Next>
                                    </FlowStep>
                                  </FlowStep.Next>
                                </FlowStep>
                              </FlowStep.Next>
                            </FlowStep>
                          </FlowStep.Next>
                        </FlowStep>
                      </FlowStep.Next>
                    </FlowStep>
                  </FlowStep.Next>
                </FlowStep>
              </FlowStep.Next>
            </FlowStep>
            <x:Reference>__ReferenceID25</x:Reference>
            <x:Reference>__ReferenceID26</x:Reference>
            <x:Reference>__ReferenceID27</x:Reference>
            <x:Reference>__ReferenceID28</x:Reference>
            <x:Reference>__ReferenceID29</x:Reference>
            <x:Reference>__ReferenceID30</x:Reference>
            <x:Reference>__ReferenceID31</x:Reference>
            <x:Reference>__ReferenceID32</x:Reference>
            <x:Reference>__ReferenceID33</x:Reference>
            <x:Reference>__ReferenceID34</x:Reference>
            <x:Reference>__ReferenceID35</x:Reference>
            <x:Reference>__ReferenceID36</x:Reference>
            <x:Reference>__ReferenceID37</x:Reference>
            <x:Reference>__ReferenceID38</x:Reference>
            <x:Reference>__ReferenceID39</x:Reference>
          </Flowchart>
        </If.Then>
        <If.Else>
          <ui:LogMessage DisplayName="日志消息" sap:VirtualizedContainerService.HintSize="334,95" sap2010:WorkflowViewState.IdRef="LogMessage_1" Level="Info" Message="[&quot;当日无按揭放款数据&quot;]" />
        </If.Else>
      </If>
    </Sequence>
  </Sequence>
</Activity>